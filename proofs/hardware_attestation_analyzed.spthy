theory HardwareAttestation begin

// Function signature and definition of the equational theory E

builtins: diffie-hellman, multiset
functions: fst/1, h/1, pair/2, pk/1, sdec/2, senc/2, sign/2, snd/1,
           true/0, verify/3
equations:
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true

heuristic: O "hardware_attestation_oracle.py"

rule (modulo E) initialize_environment:
   [ Fr( ~ca_priv ), Fr( ~kernel_priv ) ]
  --[ OnlyOnce( ), KernelKey( ~kernel_priv ), CaKey( ~ca_priv ) ]->
   [
   !CaPriv( ~ca_priv ), !CaPub( pk(~ca_priv) ),
   !KernelPrivKey( $Kernel, ~kernel_priv ),
   !KernelCertificate( $Kernel,
                       <'cert', $Kernel, pk(~kernel_priv), 
                        sign(<$Kernel, pk(~kernel_priv)>, ~ca_priv)>
   ),
   NextICUCounter( '1' ), TotalResetCounter( '1' ), Out( pk(~ca_priv) ),
   Out( pk(<'cert', $Kernel, pk(~kernel_priv), 
            sign(<$Kernel, pk(~kernel_priv)>, ~ca_priv)>)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) register_icu:
   [ Fr( ~icu_priv ), !CaPriv( ~ca_priv ), NextICUCounter( x ) ]
  --[
  IcuKey( ~icu_priv ), Unique( $ICU ), RegisterICU( $ICU ),
  RegisteredICUs( x )
  ]->
   [
   !ICUPrivKey( $ICU, ~icu_priv ),
   !ICUCertificate( $ICU,
                    <'cert', $ICU, pk(~icu_priv), sign(<$ICU, pk(~icu_priv)>, ~ca_priv)>
   ),
   UninitializedIcu( $ICU ), IcuResetCounter( $ICU, '1' ),
   NextICUCounter( ('1'+x) ),
   Out( pk(<'cert', $ICU, pk(~icu_priv), 
            sign(<$ICU, pk(~icu_priv)>, ~ca_priv)>)
   )
   ]

  // loop breaker: [2]
  /* has exactly the trivial AC variant */

rule (modulo E) reset_icu:
   [
   Icu_memory_1( $ICU, ~dh_icu_priv, kernel_cert, ~n_icu ),
   IcuResetCounter( $ICU, x ), TotalResetCounter( y )
   ]
  --[ ResetIcu( $ICU, ('1'+x) ), TotalResets( ('1'+y) ) ]->
   [
   UninitializedIcu( $ICU ), IcuResetCounter( $ICU, ('1'+x) ),
   TotalResetCounter( ('1'+y) )
   ]

  // loop breakers: [2,1,0]
  /* has exactly the trivial AC variant */

rule (modulo E) kernel_to_icu_1:
   [
   Fr( ~n_kernel ), !KernelPrivKey( $Kernel, kernel_priv ),
   !KernelCertificate( $Kernel, kernel_cert )
   ]
  --[ ProtocolStep( '1' ), BehaveKernel( $Kernel ) ]->
   [
   Kernel_memory_1( $Kernel, ~n_kernel ),
   Out( <'1', ~n_kernel, sign(~n_kernel, kernel_priv), kernel_cert> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) icu_to_kernel_1:
   [
   Fr( ~n_icu ), Fr( ~dh_icu_priv ), UninitializedIcu( $ICU ),
   In( <'1', n_kernel, n_kernel_sig_k, 'cert', kernel, kernel_pub, 
        kernel_sig>
   ),
   !ICUPrivKey( $ICU, icu_priv ), !ICUCertificate( $ICU, icu_cert ),
   !CaPub( ca_pub )
   ]
  --[
  Eq( verify(kernel_sig, <kernel, kernel_pub>, ca_pub), true ),
  Eq( verify(n_kernel_sig_k, n_kernel, kernel_pub), true ),
  NotEq( $ICU, kernel ), ProtocolStep( '2' ), BehaveICU( $ICU )
  ]->
   [
   Icu_memory_1( $ICU, ~dh_icu_priv,
                 <'cert', kernel, kernel_pub, kernel_sig>, ~n_icu
   ),
   Out( <'2', ~n_icu, sign(~n_icu, icu_priv), sign(n_kernel, icu_priv), 
         'g'^~dh_icu_priv, sign('g'^~dh_icu_priv, icu_priv), icu_cert>
   )
   ]

  /*
  rule (modulo AC) icu_to_kernel_1:
     [
     Fr( ~n_icu ), Fr( ~dh_icu_priv ), UninitializedIcu( $ICU ),
     In( <'1', n_kernel, n_kernel_sig_k, 'cert', kernel, kernel_pub, 
          kernel_sig>
     ),
     !ICUPrivKey( $ICU, icu_priv ), !ICUCertificate( $ICU, icu_cert ),
     !CaPub( ca_pub )
     ]
    --[
    Eq( z, true ), Eq( z.1, true ), NotEq( $ICU, kernel ),
    ProtocolStep( '2' ), BehaveICU( $ICU )
    ]->
     [
     Icu_memory_1( $ICU, ~dh_icu_priv,
                   <'cert', kernel, kernel_pub, kernel_sig>, ~n_icu
     ),
     Out( <'2', ~n_icu, sign(~n_icu, icu_priv), sign(n_kernel, icu_priv), 
           'g'^~dh_icu_priv, sign('g'^~dh_icu_priv, icu_priv), icu_cert>
     )
     ]
    variants (modulo AC)
    1. ca_pub
             = ca_pub.26
       kernel
             = kernel.29
       kernel_pub
             = kernel_pub.30
       kernel_sig
             = kernel_sig.31
       n_kernel
             = n_kernel.32
       n_kernel_sig_k
             = n_kernel_sig_k.33
       z     = verify(kernel_sig.31, <kernel.29, kernel_pub.30>, ca_pub.26)
       z.1   = verify(n_kernel_sig_k.33, n_kernel.32, kernel_pub.30)
    
    2. ca_pub
             = ca_pub.123
       kernel
             = kernel.126
       kernel_pub
             = pk(x.241)
       kernel_sig
             = kernel_sig.128
       n_kernel
             = n_kernel.129
       n_kernel_sig_k
             = sign(n_kernel.129, x.241)
       z     = verify(kernel_sig.128, <kernel.126, pk(x.241)>, ca_pub.123)
       z.1   = true
    
    3. ca_pub
             = pk(x.226)
       kernel
             = kernel.117
       kernel_pub
             = kernel_pub.118
       kernel_sig
             = sign(<kernel.117, kernel_pub.118>, x.226)
       n_kernel
             = n_kernel.120
       n_kernel_sig_k
             = n_kernel_sig_k.121
       z     = true
       z.1   = verify(n_kernel_sig_k.121, n_kernel.120, kernel_pub.118)
    
    4. ca_pub
             = pk(x.230)
       kernel
             = kernel.121
       kernel_pub
             = pk(x.234)
       kernel_sig
             = sign(<kernel.121, pk(x.234)>, x.230)
       n_kernel
             = n_kernel.124
       n_kernel_sig_k
             = sign(n_kernel.124, x.234)
       z     = true
       z.1   = true
  */

rule (modulo E) kernel_to_icu_2:
   [
   Kernel_memory_1( $Kernel, n_kernel ), Fr( ~dh_kernel_priv ),
   In( <'2', n_icu, n_icu_sig_i, n_kernel_sig_i, dh_icu_pub, 
        dh_icu_pub_sig, 'cert', icu, icu_pub, icu_sig>
   ),
   !KernelPrivKey( $Kernel, kernel_priv ), !CaPub( ca_pub )
   ]
  --[
  Eq( verify(n_kernel_sig_i, n_kernel, icu_pub), true ),
  Eq( verify(icu_sig, <icu, icu_pub>, ca_pub), true ),
  Eq( verify(n_icu_sig_i, n_icu, icu_pub), true ),
  Eq( verify(dh_icu_pub_sig, dh_icu_pub, icu_pub), true ),
  NotEq( $Kernel, icu ),
  KernelDone( $Kernel, icu, dh_icu_pub^~dh_kernel_priv ),
  ProtocolStep( '3' ), BehaveKernel( $Kernel )
  ]->
   [
   KernelConnection( $Kernel, icu, dh_icu_pub^~dh_kernel_priv ),
   Out( <'3', sign(n_icu, kernel_priv), 'g'^~dh_kernel_priv, 
         sign('g'^~dh_kernel_priv, kernel_priv)>
   )
   ]

  /*
  rule (modulo AC) kernel_to_icu_2:
     [
     Kernel_memory_1( $Kernel, n_kernel ), Fr( ~dh_kernel_priv ),
     In( <'2', n_icu, n_icu_sig_i, n_kernel_sig_i, dh_icu_pub, 
          dh_icu_pub_sig, 'cert', icu, icu_pub, icu_sig>
     ),
     !KernelPrivKey( $Kernel, kernel_priv ), !CaPub( ca_pub )
     ]
    --[
    Eq( z.1, true ), Eq( z.2, true ), Eq( z.3, true ), Eq( z.4, true ),
    NotEq( $Kernel, icu ), KernelDone( $Kernel, icu, z ),
    ProtocolStep( '3' ), BehaveKernel( $Kernel )
    ]->
     [
     KernelConnection( $Kernel, icu, z ),
     Out( <'3', sign(n_icu, kernel_priv), 'g'^~dh_kernel_priv, 
           sign('g'^~dh_kernel_priv, kernel_priv)>
     )
     ]
    variants (modulo AC)
     1. ~dh_kernel_priv
              = ~dh_kernel_priv.35
        ca_pub
              = ca_pub.36
        dh_icu_pub
              = dh_icu_pub.37
        dh_icu_pub_sig
              = dh_icu_pub_sig.38
        icu   = icu.39
        icu_pub
              = icu_pub.40
        icu_sig
              = icu_sig.41
        n_icu = n_icu.43
        n_icu_sig_i
              = n_icu_sig_i.44
        n_kernel
              = n_kernel.45
        n_kernel_sig_i
              = n_kernel_sig_i.46
        z     = dh_icu_pub.37^~dh_kernel_priv.35
        z.1   = verify(n_kernel_sig_i.46, n_kernel.45, icu_pub.40)
        z.2   = verify(icu_sig.41, <icu.39, icu_pub.40>, ca_pub.36)
        z.3   = verify(n_icu_sig_i.44, n_icu.43, icu_pub.40)
        z.4   = verify(dh_icu_pub_sig.38, dh_icu_pub.37, icu_pub.40)
    
     2. ~dh_kernel_priv
              = ~dh_kernel_priv.38
        ca_pub
              = ca_pub.39
        dh_icu_pub
              = z.52^inv(~dh_kernel_priv.38)
        dh_icu_pub_sig
              = dh_icu_pub_sig.41
        icu   = icu.42
        icu_pub
              = icu_pub.43
        icu_sig
              = icu_sig.44
        n_icu = n_icu.46
        n_icu_sig_i
              = n_icu_sig_i.47
        n_kernel
              = n_kernel.48
        n_kernel_sig_i
              = n_kernel_sig_i.49
        z     = z.52
        z.1   = verify(n_kernel_sig_i.49, n_kernel.48, icu_pub.43)
        z.2   = verify(icu_sig.44, <icu.42, icu_pub.43>, ca_pub.39)
        z.3   = verify(n_icu_sig_i.47, n_icu.46, icu_pub.43)
        z.4   = verify(dh_icu_pub_sig.41, z.52^inv(~dh_kernel_priv.38),
                       icu_pub.43)
    
     3. ~dh_kernel_priv
              = ~dh_kernel_priv.162
        ca_pub
              = ca_pub.163
        dh_icu_pub
              = dh_icu_pub.164
        dh_icu_pub_sig
              = dh_icu_pub_sig.165
        icu   = icu.166
        icu_pub
              = pk(x.321)
        icu_sig
              = icu_sig.168
        n_icu = n_icu.170
        n_icu_sig_i
              = n_icu_sig_i.171
        n_kernel
              = n_kernel.172
        n_kernel_sig_i
              = sign(n_kernel.172, x.321)
        z     = dh_icu_pub.164^~dh_kernel_priv.162
        z.1   = true
        z.2   = verify(icu_sig.168, <icu.166, pk(x.321)>, ca_pub.163)
        z.3   = verify(n_icu_sig_i.171, n_icu.170, pk(x.321))
        z.4   = verify(dh_icu_pub_sig.165, dh_icu_pub.164, pk(x.321))
    
     4. ~dh_kernel_priv
              = ~dh_kernel_priv.162
        ca_pub
              = ca_pub.163
        dh_icu_pub
              = dh_icu_pub.164
        dh_icu_pub_sig
              = dh_icu_pub_sig.165
        icu   = icu.166
        icu_pub
              = pk(x.321)
        icu_sig
              = icu_sig.168
        n_icu = n_icu.170
        n_icu_sig_i
              = sign(n_icu.170, x.321)
        n_kernel
              = n_kernel.172
        n_kernel_sig_i
              = n_kernel_sig_i.173
        z     = dh_icu_pub.164^~dh_kernel_priv.162
        z.1   = verify(n_kernel_sig_i.173, n_kernel.172, pk(x.321))
        z.2   = verify(icu_sig.168, <icu.166, pk(x.321)>, ca_pub.163)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.165, dh_icu_pub.164, pk(x.321))
    
     5. ~dh_kernel_priv
              = ~dh_kernel_priv.162
        ca_pub
              = ca_pub.163
        dh_icu_pub
              = dh_icu_pub.164
        dh_icu_pub_sig
              = dh_icu_pub_sig.165
        icu   = icu.166
        icu_pub
              = pk(x.321)
        icu_sig
              = icu_sig.168
        n_icu = n_icu.170
        n_icu_sig_i
              = sign(n_icu.170, x.321)
        n_kernel
              = n_kernel.172
        n_kernel_sig_i
              = sign(n_kernel.172, x.321)
        z     = dh_icu_pub.164^~dh_kernel_priv.162
        z.1   = true
        z.2   = verify(icu_sig.168, <icu.166, pk(x.321)>, ca_pub.163)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.165, dh_icu_pub.164, pk(x.321))
    
     6. ~dh_kernel_priv
              = ~dh_kernel_priv.162
        ca_pub
              = pk(x.321)
        dh_icu_pub
              = dh_icu_pub.164
        dh_icu_pub_sig
              = dh_icu_pub_sig.165
        icu   = icu.166
        icu_pub
              = icu_pub.167
        icu_sig
              = sign(<icu.166, icu_pub.167>, x.321)
        n_icu = n_icu.170
        n_icu_sig_i
              = n_icu_sig_i.171
        n_kernel
              = n_kernel.172
        n_kernel_sig_i
              = n_kernel_sig_i.173
        z     = dh_icu_pub.164^~dh_kernel_priv.162
        z.1   = verify(n_kernel_sig_i.173, n_kernel.172, icu_pub.167)
        z.2   = true
        z.3   = verify(n_icu_sig_i.171, n_icu.170, icu_pub.167)
        z.4   = verify(dh_icu_pub_sig.165, dh_icu_pub.164, icu_pub.167)
    
     7. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = ca_pub.164
        dh_icu_pub
              = dh_icu_pub.165
        dh_icu_pub_sig
              = sign(dh_icu_pub.165, x.323)
        icu   = icu.167
        icu_pub
              = pk(x.323)
        icu_sig
              = icu_sig.169
        n_icu = n_icu.171
        n_icu_sig_i
              = n_icu_sig_i.172
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = n_kernel_sig_i.174
        z     = dh_icu_pub.165^~dh_kernel_priv.163
        z.1   = verify(n_kernel_sig_i.174, n_kernel.173, pk(x.323))
        z.2   = verify(icu_sig.169, <icu.167, pk(x.323)>, ca_pub.164)
        z.3   = verify(n_icu_sig_i.172, n_icu.171, pk(x.323))
        z.4   = true
    
     8. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = ca_pub.164
        dh_icu_pub
              = dh_icu_pub.165
        dh_icu_pub_sig
              = sign(dh_icu_pub.165, x.323)
        icu   = icu.167
        icu_pub
              = pk(x.323)
        icu_sig
              = icu_sig.169
        n_icu = n_icu.171
        n_icu_sig_i
              = n_icu_sig_i.172
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = sign(n_kernel.173, x.323)
        z     = dh_icu_pub.165^~dh_kernel_priv.163
        z.1   = true
        z.2   = verify(icu_sig.169, <icu.167, pk(x.323)>, ca_pub.164)
        z.3   = verify(n_icu_sig_i.172, n_icu.171, pk(x.323))
        z.4   = true
    
     9. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = ca_pub.164
        dh_icu_pub
              = dh_icu_pub.165
        dh_icu_pub_sig
              = sign(dh_icu_pub.165, x.323)
        icu   = icu.167
        icu_pub
              = pk(x.323)
        icu_sig
              = icu_sig.169
        n_icu = n_icu.171
        n_icu_sig_i
              = sign(n_icu.171, x.323)
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = n_kernel_sig_i.174
        z     = dh_icu_pub.165^~dh_kernel_priv.163
        z.1   = verify(n_kernel_sig_i.174, n_kernel.173, pk(x.323))
        z.2   = verify(icu_sig.169, <icu.167, pk(x.323)>, ca_pub.164)
        z.3   = true
        z.4   = true
    
    10. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = ca_pub.164
        dh_icu_pub
              = dh_icu_pub.165
        dh_icu_pub_sig
              = sign(dh_icu_pub.165, x.323)
        icu   = icu.167
        icu_pub
              = pk(x.323)
        icu_sig
              = icu_sig.169
        n_icu = n_icu.171
        n_icu_sig_i
              = sign(n_icu.171, x.323)
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = sign(n_kernel.173, x.323)
        z     = dh_icu_pub.165^~dh_kernel_priv.163
        z.1   = true
        z.2   = verify(icu_sig.169, <icu.167, pk(x.323)>, ca_pub.164)
        z.3   = true
        z.4   = true
    
    11. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = ca_pub.164
        dh_icu_pub
              = x.322^x.323
        dh_icu_pub_sig
              = dh_icu_pub_sig.166
        icu   = icu.167
        icu_pub
              = icu_pub.168
        icu_sig
              = icu_sig.169
        n_icu = n_icu.171
        n_icu_sig_i
              = n_icu_sig_i.172
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = n_kernel_sig_i.174
        z     = x.322^(~dh_kernel_priv.163*x.323)
        z.1   = verify(n_kernel_sig_i.174, n_kernel.173, icu_pub.168)
        z.2   = verify(icu_sig.169, <icu.167, icu_pub.168>, ca_pub.164)
        z.3   = verify(n_icu_sig_i.172, n_icu.171, icu_pub.168)
        z.4   = verify(dh_icu_pub_sig.166, x.322^x.323, icu_pub.168)
    
    12. ~dh_kernel_priv
              = ~dh_kernel_priv.163
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = z.177^inv(~dh_kernel_priv.163)
        dh_icu_pub_sig
              = dh_icu_pub_sig.166
        icu   = icu.167
        icu_pub
              = icu_pub.168
        icu_sig
              = sign(<icu.167, icu_pub.168>, x.323)
        n_icu = n_icu.171
        n_icu_sig_i
              = n_icu_sig_i.172
        n_kernel
              = n_kernel.173
        n_kernel_sig_i
              = n_kernel_sig_i.174
        z     = z.177
        z.1   = verify(n_kernel_sig_i.174, n_kernel.173, icu_pub.168)
        z.2   = true
        z.3   = verify(n_icu_sig_i.172, n_icu.171, icu_pub.168)
        z.4   = verify(dh_icu_pub_sig.166, z.177^inv(~dh_kernel_priv.163),
                       icu_pub.168)
    
    13. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = ca_pub.165
        dh_icu_pub
              = x.323^x.324
        dh_icu_pub_sig
              = sign(x.323^x.324, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = icu_sig.170
        n_icu = n_icu.172
        n_icu_sig_i
              = n_icu_sig_i.173
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = n_kernel_sig_i.175
        z     = x.323^(~dh_kernel_priv.164*x.324)
        z.1   = verify(n_kernel_sig_i.175, n_kernel.174, pk(x.325))
        z.2   = verify(icu_sig.170, <icu.168, pk(x.325)>, ca_pub.165)
        z.3   = verify(n_icu_sig_i.173, n_icu.172, pk(x.325))
        z.4   = true
    
    14. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = ca_pub.165
        dh_icu_pub
              = x.323^x.324
        dh_icu_pub_sig
              = sign(x.323^x.324, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = icu_sig.170
        n_icu = n_icu.172
        n_icu_sig_i
              = n_icu_sig_i.173
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = sign(n_kernel.174, x.325)
        z     = x.323^(~dh_kernel_priv.164*x.324)
        z.1   = true
        z.2   = verify(icu_sig.170, <icu.168, pk(x.325)>, ca_pub.165)
        z.3   = verify(n_icu_sig_i.173, n_icu.172, pk(x.325))
        z.4   = true
    
    15. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = ca_pub.165
        dh_icu_pub
              = x.323^x.324
        dh_icu_pub_sig
              = sign(x.323^x.324, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = icu_sig.170
        n_icu = n_icu.172
        n_icu_sig_i
              = sign(n_icu.172, x.325)
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = n_kernel_sig_i.175
        z     = x.323^(~dh_kernel_priv.164*x.324)
        z.1   = verify(n_kernel_sig_i.175, n_kernel.174, pk(x.325))
        z.2   = verify(icu_sig.170, <icu.168, pk(x.325)>, ca_pub.165)
        z.3   = true
        z.4   = true
    
    16. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = ca_pub.165
        dh_icu_pub
              = x.323^x.324
        dh_icu_pub_sig
              = sign(x.323^x.324, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = icu_sig.170
        n_icu = n_icu.172
        n_icu_sig_i
              = sign(n_icu.172, x.325)
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = sign(n_kernel.174, x.325)
        z     = x.323^(~dh_kernel_priv.164*x.324)
        z.1   = true
        z.2   = verify(icu_sig.170, <icu.168, pk(x.325)>, ca_pub.165)
        z.3   = true
        z.4   = true
    
    17. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = dh_icu_pub.166
        dh_icu_pub_sig
              = sign(dh_icu_pub.166, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = sign(<icu.168, pk(x.325)>, x.323)
        n_icu = n_icu.172
        n_icu_sig_i
              = n_icu_sig_i.173
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = n_kernel_sig_i.175
        z     = dh_icu_pub.166^~dh_kernel_priv.164
        z.1   = verify(n_kernel_sig_i.175, n_kernel.174, pk(x.325))
        z.2   = true
        z.3   = verify(n_icu_sig_i.173, n_icu.172, pk(x.325))
        z.4   = true
    
    18. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = dh_icu_pub.166
        dh_icu_pub_sig
              = sign(dh_icu_pub.166, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = sign(<icu.168, pk(x.325)>, x.323)
        n_icu = n_icu.172
        n_icu_sig_i
              = n_icu_sig_i.173
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = sign(n_kernel.174, x.325)
        z     = dh_icu_pub.166^~dh_kernel_priv.164
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.173, n_icu.172, pk(x.325))
        z.4   = true
    
    19. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = dh_icu_pub.166
        dh_icu_pub_sig
              = sign(dh_icu_pub.166, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = sign(<icu.168, pk(x.325)>, x.323)
        n_icu = n_icu.172
        n_icu_sig_i
              = sign(n_icu.172, x.325)
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = n_kernel_sig_i.175
        z     = dh_icu_pub.166^~dh_kernel_priv.164
        z.1   = verify(n_kernel_sig_i.175, n_kernel.174, pk(x.325))
        z.2   = true
        z.3   = true
        z.4   = true
    
    20. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = dh_icu_pub.166
        dh_icu_pub_sig
              = sign(dh_icu_pub.166, x.325)
        icu   = icu.168
        icu_pub
              = pk(x.325)
        icu_sig
              = sign(<icu.168, pk(x.325)>, x.323)
        n_icu = n_icu.172
        n_icu_sig_i
              = sign(n_icu.172, x.325)
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = sign(n_kernel.174, x.325)
        z     = dh_icu_pub.166^~dh_kernel_priv.164
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    21. ~dh_kernel_priv
              = ~dh_kernel_priv.164
        ca_pub
              = pk(x.323)
        dh_icu_pub
              = x.324^x.325
        dh_icu_pub_sig
              = dh_icu_pub_sig.167
        icu   = icu.168
        icu_pub
              = icu_pub.169
        icu_sig
              = sign(<icu.168, icu_pub.169>, x.323)
        n_icu = n_icu.172
        n_icu_sig_i
              = n_icu_sig_i.173
        n_kernel
              = n_kernel.174
        n_kernel_sig_i
              = n_kernel_sig_i.175
        z     = x.324^(~dh_kernel_priv.164*x.325)
        z.1   = verify(n_kernel_sig_i.175, n_kernel.174, icu_pub.169)
        z.2   = true
        z.3   = verify(n_icu_sig_i.173, n_icu.172, icu_pub.169)
        z.4   = verify(dh_icu_pub_sig.167, x.324^x.325, icu_pub.169)
    
    22. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = z.179
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = verify(icu_sig.171, <icu.169, pk(x.327)>, ca_pub.166)
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    23. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = z.179
        z.1   = true
        z.2   = verify(icu_sig.171, <icu.169, pk(x.327)>, ca_pub.166)
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    24. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = z.179
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = verify(icu_sig.171, <icu.169, pk(x.327)>, ca_pub.166)
        z.3   = true
        z.4   = true
    
    25. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = z.179
        z.1   = true
        z.2   = verify(icu_sig.171, <icu.169, pk(x.327)>, ca_pub.166)
        z.3   = true
        z.4   = true
    
    26. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = x.326^inv((~dh_kernel_priv.165*x.327))
        dh_icu_pub_sig
              = dh_icu_pub_sig.168
        icu   = icu.169
        icu_pub
              = icu_pub.170
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.326^inv(x.327)
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, icu_pub.170)
        z.2   = verify(icu_sig.171, <icu.169, icu_pub.170>, ca_pub.166)
        z.3   = verify(n_icu_sig_i.174, n_icu.173, icu_pub.170)
        z.4   = verify(dh_icu_pub_sig.168,
                       x.326^inv((~dh_kernel_priv.165*x.327)), icu_pub.170)
    
    27. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = ca_pub.166
        dh_icu_pub
              = x.326^(x.327*inv(~dh_kernel_priv.165))
        dh_icu_pub_sig
              = dh_icu_pub_sig.168
        icu   = icu.169
        icu_pub
              = icu_pub.170
        icu_sig
              = icu_sig.171
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.326^x.327
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, icu_pub.170)
        z.2   = verify(icu_sig.171, <icu.169, icu_pub.170>, ca_pub.166)
        z.3   = verify(n_icu_sig_i.174, n_icu.173, icu_pub.170)
        z.4   = verify(dh_icu_pub_sig.168,
                       x.326^(x.327*inv(~dh_kernel_priv.165)), icu_pub.170)
    
    28. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.324)
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = sign(x.325^x.326, x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.324)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.325^(~dh_kernel_priv.165*x.326)
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    29. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.324)
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = sign(x.325^x.326, x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.324)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = x.325^(~dh_kernel_priv.165*x.326)
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    30. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.324)
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = sign(x.325^x.326, x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.324)
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.325^(~dh_kernel_priv.165*x.326)
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = true
        z.3   = true
        z.4   = true
    
    31. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.324)
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = sign(x.325^x.326, x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.324)
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = x.325^(~dh_kernel_priv.165*x.326)
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    32. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = z.179
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    33. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = z.179
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, pk(x.327))
        z.4   = true
    
    34. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = z.179
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, pk(x.327))
        z.2   = true
        z.3   = true
        z.4   = true
    
    35. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = z.179^inv(~dh_kernel_priv.165)
        dh_icu_pub_sig
              = sign(z.179^inv(~dh_kernel_priv.165), x.327)
        icu   = icu.169
        icu_pub
              = pk(x.327)
        icu_sig
              = sign(<icu.169, pk(x.327)>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = sign(n_icu.173, x.327)
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = sign(n_kernel.175, x.327)
        z     = z.179
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    36. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = x.326^inv((~dh_kernel_priv.165*x.327))
        dh_icu_pub_sig
              = dh_icu_pub_sig.168
        icu   = icu.169
        icu_pub
              = icu_pub.170
        icu_sig
              = sign(<icu.169, icu_pub.170>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.326^inv(x.327)
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, icu_pub.170)
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, icu_pub.170)
        z.4   = verify(dh_icu_pub_sig.168,
                       x.326^inv((~dh_kernel_priv.165*x.327)), icu_pub.170)
    
    37. ~dh_kernel_priv
              = ~dh_kernel_priv.165
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = x.326^(x.327*inv(~dh_kernel_priv.165))
        dh_icu_pub_sig
              = dh_icu_pub_sig.168
        icu   = icu.169
        icu_pub
              = icu_pub.170
        icu_sig
              = sign(<icu.169, icu_pub.170>, x.325)
        n_icu = n_icu.173
        n_icu_sig_i
              = n_icu_sig_i.174
        n_kernel
              = n_kernel.175
        n_kernel_sig_i
              = n_kernel_sig_i.176
        z     = x.326^x.327
        z.1   = verify(n_kernel_sig_i.176, n_kernel.175, icu_pub.170)
        z.2   = true
        z.3   = verify(n_icu_sig_i.174, n_icu.173, icu_pub.170)
        z.4   = verify(dh_icu_pub_sig.168,
                       x.326^(x.327*inv(~dh_kernel_priv.165)), icu_pub.170)
    
    38. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.325^(~dh_kernel_priv.166*x.326)
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = verify(dh_icu_pub_sig.169, x.325^x.326, pk(x.329))
    
    39. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.325^(~dh_kernel_priv.166*x.326)
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.169, x.325^x.326, pk(x.329))
    
    40. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.325^x.326
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.325^(~dh_kernel_priv.166*x.326)
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.169, x.325^x.326, pk(x.329))
    
    41. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^inv(x.328)
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    42. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^inv(x.328)
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    43. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^inv(x.328)
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = true
    
    44. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^inv(x.328)
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = true
    
    45. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^x.328
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    46. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^x.328
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    47. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^x.328
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = true
    
    48. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^x.328
        z.1   = true
        z.2   = verify(icu_sig.172, <icu.170, pk(x.329)>, ca_pub.167)
        z.3   = true
        z.4   = true
    
    49. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = ca_pub.167
        dh_icu_pub
              = x.327^(x.328*inv((~dh_kernel_priv.166*x.329)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = icu_pub.171
        icu_sig
              = icu_sig.172
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^(x.328*inv(x.329))
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, icu_pub.171)
        z.2   = verify(icu_sig.172, <icu.170, icu_pub.171>, ca_pub.167)
        z.3   = verify(n_icu_sig_i.175, n_icu.174, icu_pub.171)
        z.4   = verify(dh_icu_pub_sig.169,
                       x.327^(x.328*inv((~dh_kernel_priv.166*x.329))), icu_pub.171)
    
    50. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = dh_icu_pub.168
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.325)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = dh_icu_pub.168^~dh_kernel_priv.166
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = verify(dh_icu_pub_sig.169, dh_icu_pub.168, pk(x.329))
    
    51. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = dh_icu_pub.168
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.325)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = dh_icu_pub.168^~dh_kernel_priv.166
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.169, dh_icu_pub.168, pk(x.329))
    
    52. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.325)
        dh_icu_pub
              = dh_icu_pub.168
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.325)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = dh_icu_pub.168^~dh_kernel_priv.166
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.169, dh_icu_pub.168, pk(x.329))
    
    53. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^inv(x.328)
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    54. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^inv(x.328)
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    55. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^inv(x.328)
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = true
        z.3   = true
        z.4   = true
    
    56. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^inv((~dh_kernel_priv.166*x.328))
        dh_icu_pub_sig
              = sign(x.327^inv((~dh_kernel_priv.166*x.328)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^inv(x.328)
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    57. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^x.328
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    58. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^x.328
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, pk(x.329))
        z.4   = true
    
    59. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^x.328
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, pk(x.329))
        z.2   = true
        z.3   = true
        z.4   = true
    
    60. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^(x.328*inv(~dh_kernel_priv.166))
        dh_icu_pub_sig
              = sign(x.327^(x.328*inv(~dh_kernel_priv.166)), x.329)
        icu   = icu.170
        icu_pub
              = pk(x.329)
        icu_sig
              = sign(<icu.170, pk(x.329)>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = sign(n_icu.174, x.329)
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = sign(n_kernel.176, x.329)
        z     = x.327^x.328
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    61. ~dh_kernel_priv
              = ~dh_kernel_priv.166
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^(x.328*inv((~dh_kernel_priv.166*x.329)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.169
        icu   = icu.170
        icu_pub
              = icu_pub.171
        icu_sig
              = sign(<icu.170, icu_pub.171>, x.326)
        n_icu = n_icu.174
        n_icu_sig_i
              = n_icu_sig_i.175
        n_kernel
              = n_kernel.176
        n_kernel_sig_i
              = n_kernel_sig_i.177
        z     = x.327^(x.328*inv(x.329))
        z.1   = verify(n_kernel_sig_i.177, n_kernel.176, icu_pub.171)
        z.2   = true
        z.3   = verify(n_icu_sig_i.175, n_icu.174, icu_pub.171)
        z.4   = verify(dh_icu_pub_sig.169,
                       x.327^(x.328*inv((~dh_kernel_priv.166*x.329))), icu_pub.171)
    
    62. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = z.181
        z.1   = true
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    63. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = z.181
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    64. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = z.181
        z.1   = true
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    65. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = x.328^(x.329*inv(x.330))
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = true
    
    66. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.328^(x.329*inv(x.330))
        z.1   = true
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = true
    
    67. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = x.328^(x.329*inv(x.330))
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = true
        z.4   = true
    
    68. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = ca_pub.168
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = icu_sig.173
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.328^(x.329*inv(x.330))
        z.1   = true
        z.2   = verify(icu_sig.173, <icu.171, pk(x.331)>, ca_pub.168)
        z.3   = true
        z.4   = true
    
    69. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^x.328
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.326)
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.327^(~dh_kernel_priv.167*x.328)
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = verify(dh_icu_pub_sig.170, x.327^x.328, pk(x.331))
    
    70. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^x.328
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.326)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = x.327^(~dh_kernel_priv.167*x.328)
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, x.327^x.328, pk(x.331))
    
    71. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.326)
        dh_icu_pub
              = x.327^x.328
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.326)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.327^(~dh_kernel_priv.167*x.328)
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, x.327^x.328, pk(x.331))
    
    72. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = z.181
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    73. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = z.181
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    74. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = z.181^inv(~dh_kernel_priv.167)
        dh_icu_pub_sig
              = dh_icu_pub_sig.170
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = z.181
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.170, z.181^inv(~dh_kernel_priv.167),
                       pk(x.331))
    
    75. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = x.328^(x.329*inv(x.330))
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = true
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = true
    
    76. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = n_icu_sig_i.176
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.328^(x.329*inv(x.330))
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.176, n_icu.175, pk(x.331))
        z.4   = true
    
    77. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = n_kernel_sig_i.178
        z     = x.328^(x.329*inv(x.330))
        z.1   = verify(n_kernel_sig_i.178, n_kernel.177, pk(x.331))
        z.2   = true
        z.3   = true
        z.4   = true
    
    78. ~dh_kernel_priv
              = ~dh_kernel_priv.167
        ca_pub
              = pk(x.327)
        dh_icu_pub
              = x.328^(x.329*inv((~dh_kernel_priv.167*x.330)))
        dh_icu_pub_sig
              = sign(x.328^(x.329*inv((~dh_kernel_priv.167*x.330))), x.331)
        icu   = icu.171
        icu_pub
              = pk(x.331)
        icu_sig
              = sign(<icu.171, pk(x.331)>, x.327)
        n_icu = n_icu.175
        n_icu_sig_i
              = sign(n_icu.175, x.331)
        n_kernel
              = n_kernel.177
        n_kernel_sig_i
              = sign(n_kernel.177, x.331)
        z     = x.328^(x.329*inv(x.330))
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = true
    
    79. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = n_icu_sig_i.177
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^inv(x.330)
        z.1   = true
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = verify(n_icu_sig_i.177, n_icu.176, pk(x.333))
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    80. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = n_kernel_sig_i.179
        z     = x.329^inv(x.330)
        z.1   = verify(n_kernel_sig_i.179, n_kernel.178, pk(x.333))
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    81. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^inv(x.330)
        z.1   = true
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    82. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = n_icu_sig_i.177
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^x.330
        z.1   = true
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = verify(n_icu_sig_i.177, n_icu.176, pk(x.333))
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    83. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = n_kernel_sig_i.179
        z     = x.329^x.330
        z.1   = verify(n_kernel_sig_i.179, n_kernel.178, pk(x.333))
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    84. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = ca_pub.169
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = icu_sig.174
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^x.330
        z.1   = true
        z.2   = verify(icu_sig.174, <icu.172, pk(x.333)>, ca_pub.169)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    85. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = n_icu_sig_i.177
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^inv(x.330)
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.177, n_icu.176, pk(x.333))
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    86. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = n_kernel_sig_i.179
        z     = x.329^inv(x.330)
        z.1   = verify(n_kernel_sig_i.179, n_kernel.178, pk(x.333))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    87. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^inv((~dh_kernel_priv.168*x.330))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^inv(x.330)
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^inv((~dh_kernel_priv.168*x.330)), pk(x.333))
    
    88. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = n_icu_sig_i.177
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^x.330
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.177, n_icu.176, pk(x.333))
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    89. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = n_kernel_sig_i.179
        z     = x.329^x.330
        z.1   = verify(n_kernel_sig_i.179, n_kernel.178, pk(x.333))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    90. ~dh_kernel_priv
              = ~dh_kernel_priv.168
        ca_pub
              = pk(x.328)
        dh_icu_pub
              = x.329^(x.330*inv(~dh_kernel_priv.168))
        dh_icu_pub_sig
              = dh_icu_pub_sig.171
        icu   = icu.172
        icu_pub
              = pk(x.333)
        icu_sig
              = sign(<icu.172, pk(x.333)>, x.328)
        n_icu = n_icu.176
        n_icu_sig_i
              = sign(n_icu.176, x.333)
        n_kernel
              = n_kernel.178
        n_kernel_sig_i
              = sign(n_kernel.178, x.333)
        z     = x.329^x.330
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.171,
                       x.329^(x.330*inv(~dh_kernel_priv.168)), pk(x.333))
    
    91. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = ca_pub.170
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = icu_sig.175
        n_icu = n_icu.177
        n_icu_sig_i
              = n_icu_sig_i.178
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = sign(n_kernel.179, x.335)
        z     = x.330^(x.331*inv(x.332))
        z.1   = true
        z.2   = verify(icu_sig.175, <icu.173, pk(x.335)>, ca_pub.170)
        z.3   = verify(n_icu_sig_i.178, n_icu.177, pk(x.335))
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
    
    92. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = ca_pub.170
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = icu_sig.175
        n_icu = n_icu.177
        n_icu_sig_i
              = sign(n_icu.177, x.335)
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = n_kernel_sig_i.180
        z     = x.330^(x.331*inv(x.332))
        z.1   = verify(n_kernel_sig_i.180, n_kernel.179, pk(x.335))
        z.2   = verify(icu_sig.175, <icu.173, pk(x.335)>, ca_pub.170)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
    
    93. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = ca_pub.170
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = icu_sig.175
        n_icu = n_icu.177
        n_icu_sig_i
              = sign(n_icu.177, x.335)
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = sign(n_kernel.179, x.335)
        z     = x.330^(x.331*inv(x.332))
        z.1   = true
        z.2   = verify(icu_sig.175, <icu.173, pk(x.335)>, ca_pub.170)
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
    
    94. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = pk(x.329)
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = sign(<icu.173, pk(x.335)>, x.329)
        n_icu = n_icu.177
        n_icu_sig_i
              = n_icu_sig_i.178
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = sign(n_kernel.179, x.335)
        z     = x.330^(x.331*inv(x.332))
        z.1   = true
        z.2   = true
        z.3   = verify(n_icu_sig_i.178, n_icu.177, pk(x.335))
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
    
    95. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = pk(x.329)
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = sign(<icu.173, pk(x.335)>, x.329)
        n_icu = n_icu.177
        n_icu_sig_i
              = sign(n_icu.177, x.335)
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = n_kernel_sig_i.180
        z     = x.330^(x.331*inv(x.332))
        z.1   = verify(n_kernel_sig_i.180, n_kernel.179, pk(x.335))
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
    
    96. ~dh_kernel_priv
              = ~dh_kernel_priv.169
        ca_pub
              = pk(x.329)
        dh_icu_pub
              = x.330^(x.331*inv((~dh_kernel_priv.169*x.332)))
        dh_icu_pub_sig
              = dh_icu_pub_sig.172
        icu   = icu.173
        icu_pub
              = pk(x.335)
        icu_sig
              = sign(<icu.173, pk(x.335)>, x.329)
        n_icu = n_icu.177
        n_icu_sig_i
              = sign(n_icu.177, x.335)
        n_kernel
              = n_kernel.179
        n_kernel_sig_i
              = sign(n_kernel.179, x.335)
        z     = x.330^(x.331*inv(x.332))
        z.1   = true
        z.2   = true
        z.3   = true
        z.4   = verify(dh_icu_pub_sig.172,
                       x.330^(x.331*inv((~dh_kernel_priv.169*x.332))), pk(x.335))
  */

rule (modulo E) icu_to_kernel_2:
   [
   Icu_memory_1( $ICU, dh_icu_priv,
                 <'cert', kernel, kernel_pub, kernel_sig>, n_icu
   ),
   In( <'3', n_icu_sig_k, dh_kernel_pub, dh_kernel_pub_sig> )
   ]
  --[
  Eq( verify(n_icu_sig_k, n_icu, kernel_pub), true ),
  Eq( verify(dh_kernel_pub_sig, dh_kernel_pub, kernel_pub), true ),
  NotEq( $ICU, kernel ),
  ICUDone( $ICU, kernel, dh_kernel_pub^dh_icu_priv ), ProtocolStep( '4' ),
  BehaveICU( $ICU )
  ]->
   [
   ICUConnection( $ICU, kernel, dh_kernel_pub^dh_icu_priv ),
   Out( <'4', senc('ICU_Ok', dh_kernel_pub^dh_icu_priv)> )
   ]

  /*
  rule (modulo AC) icu_to_kernel_2:
     [
     Icu_memory_1( $ICU, dh_icu_priv,
                   <'cert', kernel, kernel_pub, kernel_sig>, n_icu
     ),
     In( <'3', n_icu_sig_k, dh_kernel_pub, dh_kernel_pub_sig> )
     ]
    --[
    Eq( z.1, true ), Eq( z.2, true ), NotEq( $ICU, kernel ),
    ICUDone( $ICU, kernel, z ), ProtocolStep( '4' ), BehaveICU( $ICU )
    ]->
     [ ICUConnection( $ICU, kernel, z ), Out( <'4', senc('ICU_Ok', z)> ) ]
    variants (modulo AC)
      1. dh_icu_priv
               = dh_icu_priv.25
         dh_kernel_pub
               = dh_kernel_pub.26
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.27
         kernel_pub
               = kernel_pub.29
         n_icu = n_icu.31
         n_icu_sig_k
               = n_icu_sig_k.32
         z     = dh_kernel_pub.26^dh_icu_priv.25
         z.1   = verify(n_icu_sig_k.32, n_icu.31, kernel_pub.29)
         z.2   = verify(dh_kernel_pub_sig.27, dh_kernel_pub.26, kernel_pub.29)
    
      2. dh_icu_priv
               = dh_icu_priv.28
         dh_kernel_pub
               = z.38^inv(dh_icu_priv.28)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.30
         kernel_pub
               = kernel_pub.32
         n_icu = n_icu.34
         n_icu_sig_k
               = n_icu_sig_k.35
         z     = z.38
         z.1   = verify(n_icu_sig_k.35, n_icu.34, kernel_pub.32)
         z.2   = verify(dh_kernel_pub_sig.30, z.38^inv(dh_icu_priv.28),
                        kernel_pub.32)
    
      3. dh_icu_priv
               = dh_icu_priv.63
         dh_kernel_pub
               = dh_kernel_pub.64
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.123)
         z     = dh_kernel_pub.64^dh_icu_priv.63
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65, dh_kernel_pub.64, pk(x.123))
    
      4. dh_icu_priv
               = dh_icu_priv.64
         dh_kernel_pub
               = dh_kernel_pub.65
         dh_kernel_pub_sig
               = sign(dh_kernel_pub.65, x.125)
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.70
         n_icu_sig_k
               = n_icu_sig_k.71
         z     = dh_kernel_pub.65^dh_icu_priv.64
         z.1   = verify(n_icu_sig_k.71, n_icu.70, pk(x.125))
         z.2   = true
    
      5. dh_icu_priv
               = dh_icu_priv.64
         dh_kernel_pub
               = dh_kernel_pub.65
         dh_kernel_pub_sig
               = sign(dh_kernel_pub.65, x.125)
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.70
         n_icu_sig_k
               = sign(n_icu.70, x.125)
         z     = dh_kernel_pub.65^dh_icu_priv.64
         z.1   = true
         z.2   = true
    
      6. dh_icu_priv
               = dh_icu_priv.64
         dh_kernel_pub
               = x.124^x.125
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.66
         kernel_pub
               = kernel_pub.68
         n_icu = n_icu.70
         n_icu_sig_k
               = n_icu_sig_k.71
         z     = x.124^(dh_icu_priv.64*x.125)
         z.1   = verify(n_icu_sig_k.71, n_icu.70, kernel_pub.68)
         z.2   = verify(dh_kernel_pub_sig.66, x.124^x.125, kernel_pub.68)
    
      7. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = z.75^inv(dh_icu_priv.65)
         dh_kernel_pub_sig
               = sign(z.75^inv(dh_icu_priv.65), x.127)
         kernel_pub
               = pk(x.127)
         n_icu = n_icu.71
         n_icu_sig_k
               = n_icu_sig_k.72
         z     = z.75
         z.1   = verify(n_icu_sig_k.72, n_icu.71, pk(x.127))
         z.2   = true
    
      8. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = z.75^inv(dh_icu_priv.65)
         dh_kernel_pub_sig
               = sign(z.75^inv(dh_icu_priv.65), x.127)
         kernel_pub
               = pk(x.127)
         n_icu = n_icu.71
         n_icu_sig_k
               = sign(n_icu.71, x.127)
         z     = z.75
         z.1   = true
         z.2   = true
    
      9. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = x.125^x.126
         dh_kernel_pub_sig
               = sign(x.125^x.126, x.127)
         kernel_pub
               = pk(x.127)
         n_icu = n_icu.71
         n_icu_sig_k
               = n_icu_sig_k.72
         z     = x.125^(dh_icu_priv.65*x.126)
         z.1   = verify(n_icu_sig_k.72, n_icu.71, pk(x.127))
         z.2   = true
    
     10. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = x.125^x.126
         dh_kernel_pub_sig
               = sign(x.125^x.126, x.127)
         kernel_pub
               = pk(x.127)
         n_icu = n_icu.71
         n_icu_sig_k
               = sign(n_icu.71, x.127)
         z     = x.125^(dh_icu_priv.65*x.126)
         z.1   = true
         z.2   = true
    
     11. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = x.126^inv((dh_icu_priv.65*x.127))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.67
         kernel_pub
               = kernel_pub.69
         n_icu = n_icu.71
         n_icu_sig_k
               = n_icu_sig_k.72
         z     = x.126^inv(x.127)
         z.1   = verify(n_icu_sig_k.72, n_icu.71, kernel_pub.69)
         z.2   = verify(dh_kernel_pub_sig.67, x.126^inv((dh_icu_priv.65*x.127)),
                        kernel_pub.69)
    
     12. dh_icu_priv
               = dh_icu_priv.65
         dh_kernel_pub
               = x.126^(x.127*inv(dh_icu_priv.65))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.67
         kernel_pub
               = kernel_pub.69
         n_icu = n_icu.71
         n_icu_sig_k
               = n_icu_sig_k.72
         z     = x.126^x.127
         z.1   = verify(n_icu_sig_k.72, n_icu.71, kernel_pub.69)
         z.2   = verify(dh_kernel_pub_sig.67, x.126^(x.127*inv(dh_icu_priv.65)),
                        kernel_pub.69)
    
     13. dh_icu_priv
               = dh_icu_priv.66
         dh_kernel_pub
               = x.127^inv((dh_icu_priv.66*x.128))
         dh_kernel_pub_sig
               = sign(x.127^inv((dh_icu_priv.66*x.128)), x.129)
         kernel_pub
               = pk(x.129)
         n_icu = n_icu.72
         n_icu_sig_k
               = n_icu_sig_k.73
         z     = x.127^inv(x.128)
         z.1   = verify(n_icu_sig_k.73, n_icu.72, pk(x.129))
         z.2   = true
    
     14. dh_icu_priv
               = dh_icu_priv.66
         dh_kernel_pub
               = x.127^inv((dh_icu_priv.66*x.128))
         dh_kernel_pub_sig
               = sign(x.127^inv((dh_icu_priv.66*x.128)), x.129)
         kernel_pub
               = pk(x.129)
         n_icu = n_icu.72
         n_icu_sig_k
               = sign(n_icu.72, x.129)
         z     = x.127^inv(x.128)
         z.1   = true
         z.2   = true
    
     15. dh_icu_priv
               = dh_icu_priv.66
         dh_kernel_pub
               = x.127^(x.128*inv(dh_icu_priv.66))
         dh_kernel_pub_sig
               = sign(x.127^(x.128*inv(dh_icu_priv.66)), x.129)
         kernel_pub
               = pk(x.129)
         n_icu = n_icu.72
         n_icu_sig_k
               = n_icu_sig_k.73
         z     = x.127^x.128
         z.1   = verify(n_icu_sig_k.73, n_icu.72, pk(x.129))
         z.2   = true
    
     16. dh_icu_priv
               = dh_icu_priv.66
         dh_kernel_pub
               = x.127^(x.128*inv(dh_icu_priv.66))
         dh_kernel_pub_sig
               = sign(x.127^(x.128*inv(dh_icu_priv.66)), x.129)
         kernel_pub
               = pk(x.129)
         n_icu = n_icu.72
         n_icu_sig_k
               = sign(n_icu.72, x.129)
         z     = x.127^x.128
         z.1   = true
         z.2   = true
    
     17. dh_icu_priv
               = dh_icu_priv.66
         dh_kernel_pub
               = x.127^(x.128*inv((dh_icu_priv.66*x.129)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.68
         kernel_pub
               = kernel_pub.70
         n_icu = n_icu.72
         n_icu_sig_k
               = n_icu_sig_k.73
         z     = x.127^(x.128*inv(x.129))
         z.1   = verify(n_icu_sig_k.73, n_icu.72, kernel_pub.70)
         z.2   = verify(dh_kernel_pub_sig.68,
                        x.127^(x.128*inv((dh_icu_priv.66*x.129))), kernel_pub.70)
    
     18. dh_icu_priv
               = dh_icu_priv.67
         dh_kernel_pub
               = z.77^inv(dh_icu_priv.67)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.69
         kernel_pub
               = pk(x.131)
         n_icu = n_icu.73
         n_icu_sig_k
               = sign(n_icu.73, x.131)
         z     = z.77
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.69, z.77^inv(dh_icu_priv.67), pk(x.131))
    
     19. dh_icu_priv
               = dh_icu_priv.67
         dh_kernel_pub
               = x.127^x.128
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.69
         kernel_pub
               = pk(x.131)
         n_icu = n_icu.73
         n_icu_sig_k
               = sign(n_icu.73, x.131)
         z     = x.127^(dh_icu_priv.67*x.128)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.69, x.127^x.128, pk(x.131))
    
     20. dh_icu_priv
               = dh_icu_priv.67
         dh_kernel_pub
               = x.128^(x.129*inv((dh_icu_priv.67*x.130)))
         dh_kernel_pub_sig
               = sign(x.128^(x.129*inv((dh_icu_priv.67*x.130))), x.131)
         kernel_pub
               = pk(x.131)
         n_icu = n_icu.73
         n_icu_sig_k
               = n_icu_sig_k.74
         z     = x.128^(x.129*inv(x.130))
         z.1   = verify(n_icu_sig_k.74, n_icu.73, pk(x.131))
         z.2   = true
    
     21. dh_icu_priv
               = dh_icu_priv.67
         dh_kernel_pub
               = x.128^(x.129*inv((dh_icu_priv.67*x.130)))
         dh_kernel_pub_sig
               = sign(x.128^(x.129*inv((dh_icu_priv.67*x.130))), x.131)
         kernel_pub
               = pk(x.131)
         n_icu = n_icu.73
         n_icu_sig_k
               = sign(n_icu.73, x.131)
         z     = x.128^(x.129*inv(x.130))
         z.1   = true
         z.2   = true
    
     22. dh_icu_priv
               = dh_icu_priv.68
         dh_kernel_pub
               = x.129^inv((dh_icu_priv.68*x.130))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.70
         kernel_pub
               = pk(x.133)
         n_icu = n_icu.74
         n_icu_sig_k
               = sign(n_icu.74, x.133)
         z     = x.129^inv(x.130)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.70, x.129^inv((dh_icu_priv.68*x.130)),
                        pk(x.133))
    
     23. dh_icu_priv
               = dh_icu_priv.68
         dh_kernel_pub
               = x.129^(x.130*inv(dh_icu_priv.68))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.70
         kernel_pub
               = pk(x.133)
         n_icu = n_icu.74
         n_icu_sig_k
               = sign(n_icu.74, x.133)
         z     = x.129^x.130
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.70, x.129^(x.130*inv(dh_icu_priv.68)),
                        pk(x.133))
    
     24. dh_icu_priv
               = dh_icu_priv.69
         dh_kernel_pub
               = x.130^(x.131*inv((dh_icu_priv.69*x.132)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.71
         kernel_pub
               = pk(x.135)
         n_icu = n_icu.75
         n_icu_sig_k
               = sign(n_icu.75, x.135)
         z     = x.130^(x.131*inv(x.132))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.71,
                        x.130^(x.131*inv((dh_icu_priv.69*x.132))), pk(x.135))
    
     25. dh_icu_priv
               = inv(x.83)
         dh_kernel_pub
               = z.51^x.83
         dh_kernel_pub_sig
               = sign(z.51^x.83, x.85)
         kernel_pub
               = pk(x.85)
         n_icu = n_icu.47
         n_icu_sig_k
               = n_icu_sig_k.48
         z     = z.51
         z.1   = verify(n_icu_sig_k.48, n_icu.47, pk(x.85))
         z.2   = true
    
     26. dh_icu_priv
               = inv(x.83)
         dh_kernel_pub
               = z.51^x.83
         dh_kernel_pub_sig
               = sign(z.51^x.83, x.85)
         kernel_pub
               = pk(x.85)
         n_icu = n_icu.47
         n_icu_sig_k
               = sign(n_icu.47, x.85)
         z     = z.51
         z.1   = true
         z.2   = true
    
     27. dh_icu_priv
               = inv(x.84)
         dh_kernel_pub
               = x.85^inv(x.86)
         dh_kernel_pub_sig
               = sign(x.85^inv(x.86), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = x.85^inv((x.84*x.86))
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     28. dh_icu_priv
               = inv(x.84)
         dh_kernel_pub
               = x.85^inv(x.86)
         dh_kernel_pub_sig
               = sign(x.85^inv(x.86), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = x.85^inv((x.84*x.86))
         z.1   = true
         z.2   = true
    
     29. dh_icu_priv
               = inv(x.84)
         dh_kernel_pub
               = x.85^(x.84*x.86)
         dh_kernel_pub_sig
               = sign(x.85^(x.84*x.86), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = x.85^x.86
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     30. dh_icu_priv
               = inv(x.84)
         dh_kernel_pub
               = x.85^(x.84*x.86)
         dh_kernel_pub_sig
               = sign(x.85^(x.84*x.86), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = x.85^x.86
         z.1   = true
         z.2   = true
    
     31. dh_icu_priv
               = inv(x.85)
         dh_kernel_pub
               = x.86^(x.87*inv(x.88))
         dh_kernel_pub_sig
               = sign(x.86^(x.87*inv(x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.86^(x.87*inv((x.85*x.88)))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     32. dh_icu_priv
               = inv(x.85)
         dh_kernel_pub
               = x.86^(x.87*inv(x.88))
         dh_kernel_pub_sig
               = sign(x.86^(x.87*inv(x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.86^(x.87*inv((x.85*x.88)))
         z.1   = true
         z.2   = true
    
     33. dh_icu_priv
               = inv(x.109)
         dh_kernel_pub
               = z.65^x.109
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.57
         kernel_pub
               = kernel_pub.59
         n_icu = n_icu.61
         n_icu_sig_k
               = n_icu_sig_k.62
         z     = z.65
         z.1   = verify(n_icu_sig_k.62, n_icu.61, kernel_pub.59)
         z.2   = verify(dh_kernel_pub_sig.57, z.65^x.109, kernel_pub.59)
    
     34. dh_icu_priv
               = inv(x.111)
         dh_kernel_pub
               = x.112^inv(x.113)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.59
         kernel_pub
               = kernel_pub.61
         n_icu = n_icu.63
         n_icu_sig_k
               = n_icu_sig_k.64
         z     = x.112^inv((x.111*x.113))
         z.1   = verify(n_icu_sig_k.64, n_icu.63, kernel_pub.61)
         z.2   = verify(dh_kernel_pub_sig.59, x.112^inv(x.113), kernel_pub.61)
    
     35. dh_icu_priv
               = inv(x.111)
         dh_kernel_pub
               = x.112^(x.111*x.113)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.59
         kernel_pub
               = kernel_pub.61
         n_icu = n_icu.63
         n_icu_sig_k
               = n_icu_sig_k.64
         z     = x.112^x.113
         z.1   = verify(n_icu_sig_k.64, n_icu.63, kernel_pub.61)
         z.2   = verify(dh_kernel_pub_sig.59, x.112^(x.111*x.113), kernel_pub.61)
    
     36. dh_icu_priv
               = inv(x.112)
         dh_kernel_pub
               = x.113^(x.114*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.113^(x.114*inv((x.112*x.115)))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.113^(x.114*inv(x.115)),
                        kernel_pub.62)
    
     37. dh_icu_priv
               = inv(x.113)
         dh_kernel_pub
               = z.69^x.113
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = pk(x.117)
         n_icu = n_icu.65
         n_icu_sig_k
               = sign(n_icu.65, x.117)
         z     = z.69
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.61, z.69^x.113, pk(x.117))
    
     38. dh_icu_priv
               = inv(x.114)
         dh_kernel_pub
               = x.115^inv(x.116)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = x.115^inv((x.114*x.116))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, x.115^inv(x.116), pk(x.119))
    
     39. dh_icu_priv
               = inv(x.114)
         dh_kernel_pub
               = x.115^(x.114*x.116)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = x.115^x.116
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, x.115^(x.114*x.116), pk(x.119))
    
     40. dh_icu_priv
               = inv(x.115)
         dh_kernel_pub
               = x.116^(x.117*inv(x.118))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.116^(x.117*inv((x.115*x.118)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.116^(x.117*inv(x.118)), pk(x.121))
    
     41. dh_icu_priv
               = inv((x.84*x.85))
         dh_kernel_pub
               = x.86^x.85
         dh_kernel_pub_sig
               = sign(x.86^x.85, x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = x.86^inv(x.84)
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     42. dh_icu_priv
               = inv((x.84*x.85))
         dh_kernel_pub
               = x.86^x.85
         dh_kernel_pub_sig
               = sign(x.86^x.85, x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = x.86^inv(x.84)
         z.1   = true
         z.2   = true
    
     43. dh_icu_priv
               = inv((x.85*x.86))
         dh_kernel_pub
               = x.87^(x.85*x.88)
         dh_kernel_pub_sig
               = sign(x.87^(x.85*x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^(x.88*inv(x.86))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     44. dh_icu_priv
               = inv((x.85*x.86))
         dh_kernel_pub
               = x.87^(x.85*x.88)
         dh_kernel_pub_sig
               = sign(x.87^(x.85*x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^(x.88*inv(x.86))
         z.1   = true
         z.2   = true
    
     45. dh_icu_priv
               = inv((x.85*x.86))
         dh_kernel_pub
               = x.87^(x.85*inv(x.88))
         dh_kernel_pub_sig
               = sign(x.87^(x.85*inv(x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^inv((x.86*x.88))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     46. dh_icu_priv
               = inv((x.85*x.86))
         dh_kernel_pub
               = x.87^(x.85*inv(x.88))
         dh_kernel_pub_sig
               = sign(x.87^(x.85*inv(x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^inv((x.86*x.88))
         z.1   = true
         z.2   = true
    
     47. dh_icu_priv
               = inv((x.86*x.87))
         dh_kernel_pub
               = x.88^(x.86*x.89*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.88^(x.86*x.89*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.88^(x.89*inv((x.87*x.90)))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     48. dh_icu_priv
               = inv((x.86*x.87))
         dh_kernel_pub
               = x.88^(x.86*x.89*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.88^(x.86*x.89*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.88^(x.89*inv((x.87*x.90)))
         z.1   = true
         z.2   = true
    
     49. dh_icu_priv
               = inv((x.111*x.112))
         dh_kernel_pub
               = x.113^x.112
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.59
         kernel_pub
               = kernel_pub.61
         n_icu = n_icu.63
         n_icu_sig_k
               = n_icu_sig_k.64
         z     = x.113^inv(x.111)
         z.1   = verify(n_icu_sig_k.64, n_icu.63, kernel_pub.61)
         z.2   = verify(dh_kernel_pub_sig.59, x.113^x.112, kernel_pub.61)
    
     50. dh_icu_priv
               = inv((x.112*x.113))
         dh_kernel_pub
               = x.114^(x.112*x.115)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^(x.115*inv(x.113))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.112*x.115), kernel_pub.62)
    
     51. dh_icu_priv
               = inv((x.112*x.113))
         dh_kernel_pub
               = x.114^(x.112*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^inv((x.113*x.115))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.112*inv(x.115)),
                        kernel_pub.62)
    
     52. dh_icu_priv
               = inv((x.113*x.114))
         dh_kernel_pub
               = x.115^(x.113*x.116*inv(x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.115^(x.116*inv((x.114*x.117)))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.115^(x.113*x.116*inv(x.117)),
                        kernel_pub.63)
    
     53. dh_icu_priv
               = inv((x.114*x.115))
         dh_kernel_pub
               = x.116^x.115
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = x.116^inv(x.114)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, x.116^x.115, pk(x.119))
    
     54. dh_icu_priv
               = inv((x.115*x.116))
         dh_kernel_pub
               = x.117^(x.115*x.118)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^(x.118*inv(x.116))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.115*x.118), pk(x.121))
    
     55. dh_icu_priv
               = inv((x.115*x.116))
         dh_kernel_pub
               = x.117^(x.115*inv(x.118))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^inv((x.116*x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.115*inv(x.118)), pk(x.121))
    
     56. dh_icu_priv
               = inv((x.116*x.117))
         dh_kernel_pub
               = x.118^(x.116*x.119*inv(x.120))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.118^(x.119*inv((x.117*x.120)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.118^(x.116*x.119*inv(x.120)),
                        pk(x.123))
    
     57. dh_icu_priv
               = one
         dh_kernel_pub
               = dh_kernel_pub.24
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.25
         kernel_pub
               = kernel_pub.27
         n_icu = n_icu.29
         n_icu_sig_k
               = n_icu_sig_k.30
         z     = dh_kernel_pub.24
         z.1   = verify(n_icu_sig_k.30, n_icu.29, kernel_pub.27)
         z.2   = verify(dh_kernel_pub_sig.25, dh_kernel_pub.24, kernel_pub.27)
    
     58. dh_icu_priv
               = one
         dh_kernel_pub
               = dh_kernel_pub.60
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = pk(x.116)
         n_icu = n_icu.65
         n_icu_sig_k
               = sign(n_icu.65, x.116)
         z     = dh_kernel_pub.60
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.61, dh_kernel_pub.60, pk(x.116))
    
     59. dh_icu_priv
               = one
         dh_kernel_pub
               = dh_kernel_pub.61
         dh_kernel_pub_sig
               = sign(dh_kernel_pub.61, x.118)
         kernel_pub
               = pk(x.118)
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = dh_kernel_pub.61
         z.1   = verify(n_icu_sig_k.67, n_icu.66, pk(x.118))
         z.2   = true
    
     60. dh_icu_priv
               = one
         dh_kernel_pub
               = dh_kernel_pub.61
         dh_kernel_pub_sig
               = sign(dh_kernel_pub.61, x.118)
         kernel_pub
               = pk(x.118)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.118)
         z     = dh_kernel_pub.61
         z.1   = true
         z.2   = true
    
     61. dh_icu_priv
               = (x.84*x.85)
         dh_kernel_pub
               = x.86^inv(x.84)
         dh_kernel_pub_sig
               = sign(x.86^inv(x.84), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = x.86^x.85
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     62. dh_icu_priv
               = (x.84*x.85)
         dh_kernel_pub
               = x.86^inv(x.84)
         dh_kernel_pub_sig
               = sign(x.86^inv(x.84), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = x.86^x.85
         z.1   = true
         z.2   = true
    
     63. dh_icu_priv
               = (x.84*inv(x.85))
         dh_kernel_pub
               = z.52^(x.85*inv(x.84))
         dh_kernel_pub_sig
               = sign(z.52^(x.85*inv(x.84)), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = z.52
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     64. dh_icu_priv
               = (x.84*inv(x.85))
         dh_kernel_pub
               = z.52^(x.85*inv(x.84))
         dh_kernel_pub_sig
               = sign(z.52^(x.85*inv(x.84)), x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = z.52
         z.1   = true
         z.2   = true
    
     65. dh_icu_priv
               = (x.84*inv(x.85))
         dh_kernel_pub
               = x.86^x.85
         dh_kernel_pub_sig
               = sign(x.86^x.85, x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = n_icu_sig_k.49
         z     = x.86^x.84
         z.1   = verify(n_icu_sig_k.49, n_icu.48, pk(x.87))
         z.2   = true
    
     66. dh_icu_priv
               = (x.84*inv(x.85))
         dh_kernel_pub
               = x.86^x.85
         dh_kernel_pub_sig
               = sign(x.86^x.85, x.87)
         kernel_pub
               = pk(x.87)
         n_icu = n_icu.48
         n_icu_sig_k
               = sign(n_icu.48, x.87)
         z     = x.86^x.84
         z.1   = true
         z.2   = true
    
     67. dh_icu_priv
               = (x.85*x.86)
         dh_kernel_pub
               = x.87^inv((x.85*x.88))
         dh_kernel_pub_sig
               = sign(x.87^inv((x.85*x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^(x.86*inv(x.88))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     68. dh_icu_priv
               = (x.85*x.86)
         dh_kernel_pub
               = x.87^inv((x.85*x.88))
         dh_kernel_pub_sig
               = sign(x.87^inv((x.85*x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^(x.86*inv(x.88))
         z.1   = true
         z.2   = true
    
     69. dh_icu_priv
               = (x.85*x.86)
         dh_kernel_pub
               = x.87^(x.88*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.87^(x.88*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^(x.86*x.88)
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     70. dh_icu_priv
               = (x.85*x.86)
         dh_kernel_pub
               = x.87^(x.88*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.87^(x.88*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^(x.86*x.88)
         z.1   = true
         z.2   = true
    
     71. dh_icu_priv
               = (x.85*x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.87*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.88^x.86
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     72. dh_icu_priv
               = (x.85*x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.87*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.88^x.86
         z.1   = true
         z.2   = true
    
     73. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^inv(x.88)
         dh_kernel_pub_sig
               = sign(x.87^inv(x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^(x.85*inv((x.86*x.88)))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     74. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^inv(x.88)
         dh_kernel_pub_sig
               = sign(x.87^inv(x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^(x.85*inv((x.86*x.88)))
         z.1   = true
         z.2   = true
    
     75. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^inv((x.85*x.88))
         dh_kernel_pub_sig
               = sign(x.87^inv((x.85*x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^inv((x.86*x.88))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     76. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^inv((x.85*x.88))
         dh_kernel_pub_sig
               = sign(x.87^inv((x.85*x.88)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^inv((x.86*x.88))
         z.1   = true
         z.2   = true
    
     77. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*x.88)
         dh_kernel_pub_sig
               = sign(x.87^(x.86*x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^(x.85*x.88)
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     78. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*x.88)
         dh_kernel_pub_sig
               = sign(x.87^(x.86*x.88), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^(x.85*x.88)
         z.1   = true
         z.2   = true
    
     79. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*x.88*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.87^(x.86*x.88*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^x.88
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     80. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*x.88*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.87^(x.86*x.88*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^x.88
         z.1   = true
         z.2   = true
    
     81. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*inv((x.85*x.88)))
         dh_kernel_pub_sig
               = sign(x.87^(x.86*inv((x.85*x.88))), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.87^inv(x.88)
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     82. dh_icu_priv
               = (x.85*inv(x.86))
         dh_kernel_pub
               = x.87^(x.86*inv((x.85*x.88)))
         dh_kernel_pub_sig
               = sign(x.87^(x.86*inv((x.85*x.88))), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.87^inv(x.88)
         z.1   = true
         z.2   = true
    
     83. dh_icu_priv
               = (x.85*inv((x.86*x.87)))
         dh_kernel_pub
               = x.88^x.87
         dh_kernel_pub_sig
               = sign(x.88^x.87, x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.88^(x.85*inv(x.86))
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     84. dh_icu_priv
               = (x.85*inv((x.86*x.87)))
         dh_kernel_pub
               = x.88^x.87
         dh_kernel_pub_sig
               = sign(x.88^x.87, x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.88^(x.85*inv(x.86))
         z.1   = true
         z.2   = true
    
     85. dh_icu_priv
               = (x.85*inv((x.86*x.87)))
         dh_kernel_pub
               = x.88^(x.87*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = n_icu_sig_k.50
         z     = x.88^inv(x.86)
         z.1   = verify(n_icu_sig_k.50, n_icu.49, pk(x.89))
         z.2   = true
    
     86. dh_icu_priv
               = (x.85*inv((x.86*x.87)))
         dh_kernel_pub
               = x.88^(x.87*inv(x.85))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*inv(x.85)), x.89)
         kernel_pub
               = pk(x.89)
         n_icu = n_icu.49
         n_icu_sig_k
               = sign(n_icu.49, x.89)
         z     = x.88^inv(x.86)
         z.1   = true
         z.2   = true
    
     87. dh_icu_priv
               = (x.86*x.87)
         dh_kernel_pub
               = x.88^(x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.88^(x.87*x.89*inv(x.90))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     88. dh_icu_priv
               = (x.86*x.87)
         dh_kernel_pub
               = x.88^(x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.88^(x.87*x.89*inv(x.90))
         z.1   = true
         z.2   = true
    
     89. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^inv((x.87*x.90))
         dh_kernel_pub_sig
               = sign(x.89^inv((x.87*x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.86*inv((x.88*x.90)))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     90. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^inv((x.87*x.90))
         dh_kernel_pub_sig
               = sign(x.89^inv((x.87*x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.86*inv((x.88*x.90)))
         z.1   = true
         z.2   = true
    
     91. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^(x.88*x.90*inv(x.86))
         dh_kernel_pub_sig
               = sign(x.89^(x.88*x.90*inv(x.86)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.87*x.90)
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     92. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^(x.88*x.90*inv(x.86))
         dh_kernel_pub_sig
               = sign(x.89^(x.88*x.90*inv(x.86)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.87*x.90)
         z.1   = true
         z.2   = true
    
     93. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^(x.88*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.89^(x.88*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.87*inv(x.90))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     94. dh_icu_priv
               = (x.86*x.87*inv(x.88))
         dh_kernel_pub
               = x.89^(x.88*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.89^(x.88*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.87*inv(x.90))
         z.1   = true
         z.2   = true
    
     95. dh_icu_priv
               = (x.86*x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.89*inv(x.87))
         dh_kernel_pub_sig
               = sign(x.90^(x.89*inv(x.87)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.90^(x.86*inv(x.88))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     96. dh_icu_priv
               = (x.86*x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.89*inv(x.87))
         dh_kernel_pub_sig
               = sign(x.90^(x.89*inv(x.87)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.90^(x.86*inv(x.88))
         z.1   = true
         z.2   = true
    
     97. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.87*x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.88^(x.89*inv(x.90))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
     98. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.87*x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.87*x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.88^(x.89*inv(x.90))
         z.1   = true
         z.2   = true
    
     99. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.89*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.88^(x.86*x.89*inv((x.87*x.90)))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    100. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.89*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.88^(x.86*x.89*inv((x.87*x.90)))
         z.1   = true
         z.2   = true
    
    101. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.88^(x.89*inv((x.87*x.90)))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    102. dh_icu_priv
               = (x.86*inv(x.87))
         dh_kernel_pub
               = x.88^(x.89*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.88^(x.89*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.88^(x.89*inv((x.87*x.90)))
         z.1   = true
         z.2   = true
    
    103. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*x.90)
         dh_kernel_pub_sig
               = sign(x.89^(x.87*x.90), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.86*x.90*inv(x.88))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    104. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*x.90)
         dh_kernel_pub_sig
               = sign(x.89^(x.87*x.90), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.86*x.90*inv(x.88))
         z.1   = true
         z.2   = true
    
    105. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*x.90*inv(x.86))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*x.90*inv(x.86)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.90*inv(x.88))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    106. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*x.90*inv(x.86))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*x.90*inv(x.86)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.90*inv(x.88))
         z.1   = true
         z.2   = true
    
    107. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^(x.86*inv((x.88*x.90)))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    108. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*inv(x.90))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*inv(x.90)), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^(x.86*inv((x.88*x.90)))
         z.1   = true
         z.2   = true
    
    109. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = n_icu_sig_k.51
         z     = x.89^inv((x.88*x.90))
         z.1   = verify(n_icu_sig_k.51, n_icu.50, pk(x.91))
         z.2   = true
    
    110. dh_icu_priv
               = (x.86*inv((x.87*x.88)))
         dh_kernel_pub
               = x.89^(x.87*inv((x.86*x.90)))
         dh_kernel_pub_sig
               = sign(x.89^(x.87*inv((x.86*x.90))), x.91)
         kernel_pub
               = pk(x.91)
         n_icu = n_icu.50
         n_icu_sig_k
               = sign(n_icu.50, x.91)
         z     = x.89^inv((x.88*x.90))
         z.1   = true
         z.2   = true
    
    111. dh_icu_priv
               = (x.87*x.88*inv(x.89))
         dh_kernel_pub
               = x.90^(x.89*x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.89*x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.90^(x.88*x.91*inv(x.92))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    112. dh_icu_priv
               = (x.87*x.88*inv(x.89))
         dh_kernel_pub
               = x.90^(x.89*x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.89*x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.90^(x.88*x.91*inv(x.92))
         z.1   = true
         z.2   = true
    
    113. dh_icu_priv
               = (x.87*x.88*inv(x.89))
         dh_kernel_pub
               = x.90^(x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.90^(x.88*x.91*inv((x.89*x.92)))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    114. dh_icu_priv
               = (x.87*x.88*inv(x.89))
         dh_kernel_pub
               = x.90^(x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.90^(x.88*x.91*inv((x.89*x.92)))
         z.1   = true
         z.2   = true
    
    115. dh_icu_priv
               = (x.87*x.88*inv((x.89*x.90)))
         dh_kernel_pub
               = x.91^(x.89*x.92*inv(x.87))
         dh_kernel_pub_sig
               = sign(x.91^(x.89*x.92*inv(x.87)), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.91^(x.88*x.92*inv(x.90))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    116. dh_icu_priv
               = (x.87*x.88*inv((x.89*x.90)))
         dh_kernel_pub
               = x.91^(x.89*x.92*inv(x.87))
         dh_kernel_pub_sig
               = sign(x.91^(x.89*x.92*inv(x.87)), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.91^(x.88*x.92*inv(x.90))
         z.1   = true
         z.2   = true
    
    117. dh_icu_priv
               = (x.87*x.88*inv((x.89*x.90)))
         dh_kernel_pub
               = x.91^(x.89*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.91^(x.89*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.91^(x.88*inv((x.90*x.92)))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    118. dh_icu_priv
               = (x.87*x.88*inv((x.89*x.90)))
         dh_kernel_pub
               = x.91^(x.89*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.91^(x.89*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.91^(x.88*inv((x.90*x.92)))
         z.1   = true
         z.2   = true
    
    119. dh_icu_priv
               = (x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.88*x.91*inv(x.92))
         dh_kernel_pub_sig
               = sign(x.90^(x.88*x.91*inv(x.92)), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.90^(x.87*x.91*inv((x.89*x.92)))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    120. dh_icu_priv
               = (x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.88*x.91*inv(x.92))
         dh_kernel_pub_sig
               = sign(x.90^(x.88*x.91*inv(x.92)), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.90^(x.87*x.91*inv((x.89*x.92)))
         z.1   = true
         z.2   = true
    
    121. dh_icu_priv
               = (x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.88*x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.88*x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = n_icu_sig_k.52
         z     = x.90^(x.91*inv((x.89*x.92)))
         z.1   = verify(n_icu_sig_k.52, n_icu.51, pk(x.93))
         z.2   = true
    
    122. dh_icu_priv
               = (x.87*inv((x.88*x.89)))
         dh_kernel_pub
               = x.90^(x.88*x.91*inv((x.87*x.92)))
         dh_kernel_pub_sig
               = sign(x.90^(x.88*x.91*inv((x.87*x.92))), x.93)
         kernel_pub
               = pk(x.93)
         n_icu = n_icu.51
         n_icu_sig_k
               = sign(n_icu.51, x.93)
         z     = x.90^(x.91*inv((x.89*x.92)))
         z.1   = true
         z.2   = true
    
    123. dh_icu_priv
               = (x.88*x.89*inv((x.90*x.91)))
         dh_kernel_pub
               = x.92^(x.90*x.93*inv((x.88*x.94)))
         dh_kernel_pub_sig
               = sign(x.92^(x.90*x.93*inv((x.88*x.94))), x.95)
         kernel_pub
               = pk(x.95)
         n_icu = n_icu.52
         n_icu_sig_k
               = n_icu_sig_k.53
         z     = x.92^(x.89*x.93*inv((x.91*x.94)))
         z.1   = verify(n_icu_sig_k.53, n_icu.52, pk(x.95))
         z.2   = true
    
    124. dh_icu_priv
               = (x.88*x.89*inv((x.90*x.91)))
         dh_kernel_pub
               = x.92^(x.90*x.93*inv((x.88*x.94)))
         dh_kernel_pub_sig
               = sign(x.92^(x.90*x.93*inv((x.88*x.94))), x.95)
         kernel_pub
               = pk(x.95)
         n_icu = n_icu.52
         n_icu_sig_k
               = sign(n_icu.52, x.95)
         z     = x.92^(x.89*x.93*inv((x.91*x.94)))
         z.1   = true
         z.2   = true
    
    125. dh_icu_priv
               = (x.110*inv(x.111))
         dh_kernel_pub
               = z.66^(x.111*inv(x.110))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.58
         kernel_pub
               = kernel_pub.60
         n_icu = n_icu.62
         n_icu_sig_k
               = n_icu_sig_k.63
         z     = z.66
         z.1   = verify(n_icu_sig_k.63, n_icu.62, kernel_pub.60)
         z.2   = verify(dh_kernel_pub_sig.58, z.66^(x.111*inv(x.110)),
                        kernel_pub.60)
    
    126. dh_icu_priv
               = (x.111*x.112)
         dh_kernel_pub
               = x.113^inv(x.111)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.59
         kernel_pub
               = kernel_pub.61
         n_icu = n_icu.63
         n_icu_sig_k
               = n_icu_sig_k.64
         z     = x.113^x.112
         z.1   = verify(n_icu_sig_k.64, n_icu.63, kernel_pub.61)
         z.2   = verify(dh_kernel_pub_sig.59, x.113^inv(x.111), kernel_pub.61)
    
    127. dh_icu_priv
               = (x.111*inv(x.112))
         dh_kernel_pub
               = x.113^x.112
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.59
         kernel_pub
               = kernel_pub.61
         n_icu = n_icu.63
         n_icu_sig_k
               = n_icu_sig_k.64
         z     = x.113^x.111
         z.1   = verify(n_icu_sig_k.64, n_icu.63, kernel_pub.61)
         z.2   = verify(dh_kernel_pub_sig.59, x.113^x.112, kernel_pub.61)
    
    128. dh_icu_priv
               = (x.112*x.113)
         dh_kernel_pub
               = x.114^inv((x.112*x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^(x.113*inv(x.115))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^inv((x.112*x.115)),
                        kernel_pub.62)
    
    129. dh_icu_priv
               = (x.112*x.113)
         dh_kernel_pub
               = x.114^(x.115*inv(x.112))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^(x.113*x.115)
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.115*inv(x.112)),
                        kernel_pub.62)
    
    130. dh_icu_priv
               = (x.112*x.113*inv(x.114))
         dh_kernel_pub
               = x.115^(x.114*inv(x.112))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.115^x.113
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.115^(x.114*inv(x.112)),
                        kernel_pub.62)
    
    131. dh_icu_priv
               = (x.112*inv(x.113))
         dh_kernel_pub
               = x.114^inv(x.115)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^(x.112*inv((x.113*x.115)))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^inv(x.115), kernel_pub.62)
    
    132. dh_icu_priv
               = (x.112*inv(x.113))
         dh_kernel_pub
               = x.114^inv((x.112*x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^inv((x.113*x.115))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^inv((x.112*x.115)),
                        kernel_pub.62)
    
    133. dh_icu_priv
               = (x.112*inv(x.113))
         dh_kernel_pub
               = x.114^(x.113*x.115)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^(x.112*x.115)
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.113*x.115), kernel_pub.62)
    
    134. dh_icu_priv
               = (x.112*inv(x.113))
         dh_kernel_pub
               = x.114^(x.113*x.115*inv(x.112))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^x.115
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.113*x.115*inv(x.112)),
                        kernel_pub.62)
    
    135. dh_icu_priv
               = (x.112*inv(x.113))
         dh_kernel_pub
               = x.114^(x.113*inv((x.112*x.115)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.114^inv(x.115)
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.114^(x.113*inv((x.112*x.115))),
                        kernel_pub.62)
    
    136. dh_icu_priv
               = (x.112*inv((x.113*x.114)))
         dh_kernel_pub
               = x.115^x.114
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.115^(x.112*inv(x.113))
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.115^x.114, kernel_pub.62)
    
    137. dh_icu_priv
               = (x.112*inv((x.113*x.114)))
         dh_kernel_pub
               = x.115^(x.114*inv(x.112))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.60
         kernel_pub
               = kernel_pub.62
         n_icu = n_icu.64
         n_icu_sig_k
               = n_icu_sig_k.65
         z     = x.115^inv(x.113)
         z.1   = verify(n_icu_sig_k.65, n_icu.64, kernel_pub.62)
         z.2   = verify(dh_kernel_pub_sig.60, x.115^(x.114*inv(x.112)),
                        kernel_pub.62)
    
    138. dh_icu_priv
               = (x.113*x.114)
         dh_kernel_pub
               = x.115^(x.116*inv((x.113*x.117)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.115^(x.114*x.116*inv(x.117))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.115^(x.116*inv((x.113*x.117))),
                        kernel_pub.63)
    
    139. dh_icu_priv
               = (x.113*x.114*inv(x.115))
         dh_kernel_pub
               = x.116^inv((x.114*x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.113*inv((x.115*x.117)))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^inv((x.114*x.117)),
                        kernel_pub.63)
    
    140. dh_icu_priv
               = (x.113*x.114*inv(x.115))
         dh_kernel_pub
               = x.116^(x.115*x.117*inv(x.113))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.114*x.117)
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.115*x.117*inv(x.113)),
                        kernel_pub.63)
    
    141. dh_icu_priv
               = (x.113*x.114*inv(x.115))
         dh_kernel_pub
               = x.116^(x.115*inv((x.113*x.117)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.114*inv(x.117))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.115*inv((x.113*x.117))),
                        kernel_pub.63)
    
    142. dh_icu_priv
               = (x.113*x.114*inv((x.115*x.116)))
         dh_kernel_pub
               = x.117^(x.116*inv(x.114))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.117^(x.113*inv(x.115))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.117^(x.116*inv(x.114)),
                        kernel_pub.63)
    
    143. dh_icu_priv
               = (x.113*inv(x.114))
         dh_kernel_pub
               = x.115^(x.114*x.116*inv((x.113*x.117)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.115^(x.116*inv(x.117))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61,
                        x.115^(x.114*x.116*inv((x.113*x.117))), kernel_pub.63)
    
    144. dh_icu_priv
               = (x.113*inv(x.114))
         dh_kernel_pub
               = x.115^(x.116*inv(x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.115^(x.113*x.116*inv((x.114*x.117)))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.115^(x.116*inv(x.117)),
                        kernel_pub.63)
    
    145. dh_icu_priv
               = (x.113*inv(x.114))
         dh_kernel_pub
               = x.115^(x.116*inv((x.113*x.117)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.115^(x.116*inv((x.114*x.117)))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.115^(x.116*inv((x.113*x.117))),
                        kernel_pub.63)
    
    146. dh_icu_priv
               = (x.113*inv((x.114*x.115)))
         dh_kernel_pub
               = x.116^(x.114*x.117)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.113*x.117*inv(x.115))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.114*x.117), kernel_pub.63)
    
    147. dh_icu_priv
               = (x.113*inv((x.114*x.115)))
         dh_kernel_pub
               = x.116^(x.114*x.117*inv(x.113))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.117*inv(x.115))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.114*x.117*inv(x.113)),
                        kernel_pub.63)
    
    148. dh_icu_priv
               = (x.113*inv((x.114*x.115)))
         dh_kernel_pub
               = x.116^(x.114*inv(x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^(x.113*inv((x.115*x.117)))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.114*inv(x.117)),
                        kernel_pub.63)
    
    149. dh_icu_priv
               = (x.113*inv((x.114*x.115)))
         dh_kernel_pub
               = x.116^(x.114*inv((x.113*x.117)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.61
         kernel_pub
               = kernel_pub.63
         n_icu = n_icu.65
         n_icu_sig_k
               = n_icu_sig_k.66
         z     = x.116^inv((x.115*x.117))
         z.1   = verify(n_icu_sig_k.66, n_icu.65, kernel_pub.63)
         z.2   = verify(dh_kernel_pub_sig.61, x.116^(x.114*inv((x.113*x.117))),
                        kernel_pub.63)
    
    150. dh_icu_priv
               = (x.114*x.115)
         dh_kernel_pub
               = x.116^inv(x.114)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = x.116^x.115
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, x.116^inv(x.114), pk(x.119))
    
    151. dh_icu_priv
               = (x.114*x.115*inv(x.116))
         dh_kernel_pub
               = x.117^(x.116*x.118*inv((x.114*x.119)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.117^(x.115*x.118*inv(x.119))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62,
                        x.117^(x.116*x.118*inv((x.114*x.119))), kernel_pub.64)
    
    152. dh_icu_priv
               = (x.114*x.115*inv(x.116))
         dh_kernel_pub
               = x.117^(x.118*inv((x.114*x.119)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.117^(x.115*x.118*inv((x.116*x.119)))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62, x.117^(x.118*inv((x.114*x.119))),
                        kernel_pub.64)
    
    153. dh_icu_priv
               = (x.114*x.115*inv((x.116*x.117)))
         dh_kernel_pub
               = x.118^(x.116*x.119*inv(x.114))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.118^(x.115*x.119*inv(x.117))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62, x.118^(x.116*x.119*inv(x.114)),
                        kernel_pub.64)
    
    154. dh_icu_priv
               = (x.114*x.115*inv((x.116*x.117)))
         dh_kernel_pub
               = x.118^(x.116*inv((x.114*x.119)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.118^(x.115*inv((x.117*x.119)))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62, x.118^(x.116*inv((x.114*x.119))),
                        kernel_pub.64)
    
    155. dh_icu_priv
               = (x.114*inv(x.115))
         dh_kernel_pub
               = z.70^(x.115*inv(x.114))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = z.70
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, z.70^(x.115*inv(x.114)), pk(x.119))
    
    156. dh_icu_priv
               = (x.114*inv(x.115))
         dh_kernel_pub
               = x.116^x.115
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = pk(x.119)
         n_icu = n_icu.66
         n_icu_sig_k
               = sign(n_icu.66, x.119)
         z     = x.116^x.114
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.62, x.116^x.115, pk(x.119))
    
    157. dh_icu_priv
               = (x.114*inv((x.115*x.116)))
         dh_kernel_pub
               = x.117^(x.115*x.118*inv(x.119))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.117^(x.114*x.118*inv((x.116*x.119)))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62, x.117^(x.115*x.118*inv(x.119)),
                        kernel_pub.64)
    
    158. dh_icu_priv
               = (x.114*inv((x.115*x.116)))
         dh_kernel_pub
               = x.117^(x.115*x.118*inv((x.114*x.119)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.62
         kernel_pub
               = kernel_pub.64
         n_icu = n_icu.66
         n_icu_sig_k
               = n_icu_sig_k.67
         z     = x.117^(x.118*inv((x.116*x.119)))
         z.1   = verify(n_icu_sig_k.67, n_icu.66, kernel_pub.64)
         z.2   = verify(dh_kernel_pub_sig.62,
                        x.117^(x.115*x.118*inv((x.114*x.119))), kernel_pub.64)
    
    159. dh_icu_priv
               = (x.115*x.116)
         dh_kernel_pub
               = x.117^inv((x.115*x.118))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^(x.116*inv(x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^inv((x.115*x.118)), pk(x.121))
    
    160. dh_icu_priv
               = (x.115*x.116)
         dh_kernel_pub
               = x.117^(x.118*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^(x.116*x.118)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.118*inv(x.115)), pk(x.121))
    
    161. dh_icu_priv
               = (x.115*x.116*inv(x.117))
         dh_kernel_pub
               = x.118^(x.117*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.118^x.116
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.118^(x.117*inv(x.115)), pk(x.121))
    
    162. dh_icu_priv
               = (x.115*x.116*inv((x.117*x.118)))
         dh_kernel_pub
               = x.119^(x.117*x.120*inv((x.115*x.121)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = kernel_pub.65
         n_icu = n_icu.67
         n_icu_sig_k
               = n_icu_sig_k.68
         z     = x.119^(x.116*x.120*inv((x.118*x.121)))
         z.1   = verify(n_icu_sig_k.68, n_icu.67, kernel_pub.65)
         z.2   = verify(dh_kernel_pub_sig.63,
                        x.119^(x.117*x.120*inv((x.115*x.121))), kernel_pub.65)
    
    163. dh_icu_priv
               = (x.115*inv(x.116))
         dh_kernel_pub
               = x.117^inv(x.118)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^(x.115*inv((x.116*x.118)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^inv(x.118), pk(x.121))
    
    164. dh_icu_priv
               = (x.115*inv(x.116))
         dh_kernel_pub
               = x.117^inv((x.115*x.118))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^inv((x.116*x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^inv((x.115*x.118)), pk(x.121))
    
    165. dh_icu_priv
               = (x.115*inv(x.116))
         dh_kernel_pub
               = x.117^(x.116*x.118)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^(x.115*x.118)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.116*x.118), pk(x.121))
    
    166. dh_icu_priv
               = (x.115*inv(x.116))
         dh_kernel_pub
               = x.117^(x.116*x.118*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^x.118
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.116*x.118*inv(x.115)),
                        pk(x.121))
    
    167. dh_icu_priv
               = (x.115*inv(x.116))
         dh_kernel_pub
               = x.117^(x.116*inv((x.115*x.118)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.117^inv(x.118)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.117^(x.116*inv((x.115*x.118))),
                        pk(x.121))
    
    168. dh_icu_priv
               = (x.115*inv((x.116*x.117)))
         dh_kernel_pub
               = x.118^x.117
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.118^(x.115*inv(x.116))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.118^x.117, pk(x.121))
    
    169. dh_icu_priv
               = (x.115*inv((x.116*x.117)))
         dh_kernel_pub
               = x.118^(x.117*inv(x.115))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.63
         kernel_pub
               = pk(x.121)
         n_icu = n_icu.67
         n_icu_sig_k
               = sign(n_icu.67, x.121)
         z     = x.118^inv(x.116)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.63, x.118^(x.117*inv(x.115)), pk(x.121))
    
    170. dh_icu_priv
               = (x.116*x.117)
         dh_kernel_pub
               = x.118^(x.119*inv((x.116*x.120)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.118^(x.117*x.119*inv(x.120))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.118^(x.119*inv((x.116*x.120))),
                        pk(x.123))
    
    171. dh_icu_priv
               = (x.116*x.117*inv(x.118))
         dh_kernel_pub
               = x.119^inv((x.117*x.120))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.116*inv((x.118*x.120)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^inv((x.117*x.120)), pk(x.123))
    
    172. dh_icu_priv
               = (x.116*x.117*inv(x.118))
         dh_kernel_pub
               = x.119^(x.118*x.120*inv(x.116))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.117*x.120)
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.118*x.120*inv(x.116)),
                        pk(x.123))
    
    173. dh_icu_priv
               = (x.116*x.117*inv(x.118))
         dh_kernel_pub
               = x.119^(x.118*inv((x.116*x.120)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.117*inv(x.120))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.118*inv((x.116*x.120))),
                        pk(x.123))
    
    174. dh_icu_priv
               = (x.116*x.117*inv((x.118*x.119)))
         dh_kernel_pub
               = x.120^(x.119*inv(x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.120^(x.116*inv(x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.120^(x.119*inv(x.117)), pk(x.123))
    
    175. dh_icu_priv
               = (x.116*inv(x.117))
         dh_kernel_pub
               = x.118^(x.117*x.119*inv((x.116*x.120)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.118^(x.119*inv(x.120))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64,
                        x.118^(x.117*x.119*inv((x.116*x.120))), pk(x.123))
    
    176. dh_icu_priv
               = (x.116*inv(x.117))
         dh_kernel_pub
               = x.118^(x.119*inv(x.120))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.118^(x.116*x.119*inv((x.117*x.120)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.118^(x.119*inv(x.120)), pk(x.123))
    
    177. dh_icu_priv
               = (x.116*inv(x.117))
         dh_kernel_pub
               = x.118^(x.119*inv((x.116*x.120)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.118^(x.119*inv((x.117*x.120)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.118^(x.119*inv((x.116*x.120))),
                        pk(x.123))
    
    178. dh_icu_priv
               = (x.116*inv((x.117*x.118)))
         dh_kernel_pub
               = x.119^(x.117*x.120)
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.116*x.120*inv(x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.117*x.120), pk(x.123))
    
    179. dh_icu_priv
               = (x.116*inv((x.117*x.118)))
         dh_kernel_pub
               = x.119^(x.117*x.120*inv(x.116))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.120*inv(x.118))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.117*x.120*inv(x.116)),
                        pk(x.123))
    
    180. dh_icu_priv
               = (x.116*inv((x.117*x.118)))
         dh_kernel_pub
               = x.119^(x.117*inv(x.120))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^(x.116*inv((x.118*x.120)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.117*inv(x.120)), pk(x.123))
    
    181. dh_icu_priv
               = (x.116*inv((x.117*x.118)))
         dh_kernel_pub
               = x.119^(x.117*inv((x.116*x.120)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.64
         kernel_pub
               = pk(x.123)
         n_icu = n_icu.68
         n_icu_sig_k
               = sign(n_icu.68, x.123)
         z     = x.119^inv((x.118*x.120))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.64, x.119^(x.117*inv((x.116*x.120))),
                        pk(x.123))
    
    182. dh_icu_priv
               = (x.117*x.118*inv(x.119))
         dh_kernel_pub
               = x.120^(x.119*x.121*inv((x.117*x.122)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.120^(x.118*x.121*inv(x.122))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65,
                        x.120^(x.119*x.121*inv((x.117*x.122))), pk(x.125))
    
    183. dh_icu_priv
               = (x.117*x.118*inv(x.119))
         dh_kernel_pub
               = x.120^(x.121*inv((x.117*x.122)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.120^(x.118*x.121*inv((x.119*x.122)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65, x.120^(x.121*inv((x.117*x.122))),
                        pk(x.125))
    
    184. dh_icu_priv
               = (x.117*x.118*inv((x.119*x.120)))
         dh_kernel_pub
               = x.121^(x.119*x.122*inv(x.117))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.121^(x.118*x.122*inv(x.120))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65, x.121^(x.119*x.122*inv(x.117)),
                        pk(x.125))
    
    185. dh_icu_priv
               = (x.117*x.118*inv((x.119*x.120)))
         dh_kernel_pub
               = x.121^(x.119*inv((x.117*x.122)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.121^(x.118*inv((x.120*x.122)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65, x.121^(x.119*inv((x.117*x.122))),
                        pk(x.125))
    
    186. dh_icu_priv
               = (x.117*inv((x.118*x.119)))
         dh_kernel_pub
               = x.120^(x.118*x.121*inv(x.122))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.120^(x.117*x.121*inv((x.119*x.122)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65, x.120^(x.118*x.121*inv(x.122)),
                        pk(x.125))
    
    187. dh_icu_priv
               = (x.117*inv((x.118*x.119)))
         dh_kernel_pub
               = x.120^(x.118*x.121*inv((x.117*x.122)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.65
         kernel_pub
               = pk(x.125)
         n_icu = n_icu.69
         n_icu_sig_k
               = sign(n_icu.69, x.125)
         z     = x.120^(x.121*inv((x.119*x.122)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.65,
                        x.120^(x.118*x.121*inv((x.117*x.122))), pk(x.125))
    
    188. dh_icu_priv
               = (x.118*x.119*inv((x.120*x.121)))
         dh_kernel_pub
               = x.122^(x.120*x.123*inv((x.118*x.124)))
         dh_kernel_pub_sig
               = dh_kernel_pub_sig.66
         kernel_pub
               = pk(x.127)
         n_icu = n_icu.70
         n_icu_sig_k
               = sign(n_icu.70, x.127)
         z     = x.122^(x.119*x.123*inv((x.121*x.124)))
         z.1   = true
         z.2   = verify(dh_kernel_pub_sig.66,
                        x.122^(x.120*x.123*inv((x.118*x.124))), pk(x.127))
  */

rule (modulo E) kernel_to_icu_3:
   [ KernelConnection( $Kernel, icu, dh_common ), In( <'4', enc_msg> ) ]
  --[
  Eq( sdec(enc_msg, dh_common), 'ICU_Ok' ),
  KernelTrusts( $Kernel, icu, dh_common ), ProtocolStep( '5' ),
  BehaveKernel( $Kernel )
  ]->
   [ Out( <'5', senc('Kernel_Ok', dh_common)> ) ]

  /*
  rule (modulo AC) kernel_to_icu_3:
     [ KernelConnection( $Kernel, icu, dh_common ), In( <'4', enc_msg> ) ]
    --[
    Eq( z, 'ICU_Ok' ), KernelTrusts( $Kernel, icu, dh_common ),
    ProtocolStep( '5' ), BehaveKernel( $Kernel )
    ]->
     [ Out( <'5', senc('Kernel_Ok', dh_common)> ) ]
    variants (modulo AC)
    1. dh_common
             = dh_common.11
       enc_msg
             = enc_msg.12
       z     = sdec(enc_msg.12, dh_common.11)
    
    2. dh_common
             = dh_common.16
       enc_msg
             = senc(z.22, dh_common.16)
       z     = z.22
  */

rule (modulo E) icu_to_kernel_3:
   [ ICUConnection( $ICU, kernel, dh_common ), In( <'5', enc_msg> ) ]
  --[
  Eq( sdec(enc_msg, dh_common), 'Kernel_Ok' ),
  ICUTrusts( $ICU, kernel, dh_common ), ProtocolStep( '6' ),
  BehaveICU( $ICU )
  ]->
   [ ]

  /*
  rule (modulo AC) icu_to_kernel_3:
     [ ICUConnection( $ICU, kernel, dh_common ), In( <'5', enc_msg> ) ]
    --[
    Eq( z, 'Kernel_Ok' ), ICUTrusts( $ICU, kernel, dh_common ),
    ProtocolStep( '6' ), BehaveICU( $ICU )
    ]->
     [ ]
    variants (modulo AC)
    1. dh_common
             = dh_common.9
       enc_msg
             = enc_msg.10
       z     = sdec(enc_msg.10, dh_common.9)
    
    2. dh_common
             = dh_common.12
       enc_msg
             = senc(z.16, dh_common.12)
       z     = z.16
  */

restriction equality:
  "∀ x y #i. (Eq( x, y ) @ #i) ⇒ (x = y)"
  // safety formula

restriction inequality:
  "∀ x y #i. (NotEq( x, y ) @ #i) ⇒ (¬(x = y))"
  // safety formula

restriction only_once:
  "∀ #i #j. ((OnlyOnce( ) @ #i) ∧ (OnlyOnce( ) @ #j)) ⇒ (#i = #j)"
  // safety formula

restriction uniqueness:
  "∀ x #i #j. ((Unique( x ) @ #i) ∧ (Unique( x ) @ #j)) ⇒ (#i = #j)"
  // safety formula

lemma valid_session_can_be_created:
  exists-trace
  "((∀ icu1 icu2 #i #j.
      ((RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j)) ⇒
      (icu1 = icu2)) ∧
    (¬(∃ icu x #i. ResetIcu( icu, x ) @ #i))) ∧
   (∃ kernel icu common_key #i #j.
     (KernelDone( kernel, icu, common_key ) @ #i) ∧
     (ICUDone( icu, kernel, common_key ) @ #j))"
/*
guarded formula characterizing all satisfying traces:
"(∀ icu1 icu2 #i #j.
   (RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j) ⇒ icu1 = icu2) ∧
 (∀ icu x #i. (ResetIcu( icu, x ) @ #i) ⇒ ⊥) ∧
 (∃ kernel icu common_key #i #j.
   (KernelDone( kernel, icu, common_key ) @ #i) ∧
   (ICUDone( icu, kernel, common_key ) @ #j))"
*/
simplify
solve( Kernel_memory_1( $Kernel, n_kernel ) ▶₀ #i )
  case kernel_to_icu_1
  solve( !KernelPrivKey( $Kernel, kernel_priv ) ▶₃ #i )
    case initialize_environment
    solve( !CaPub( pk(x.1) ) ▶₄ #i )
      case initialize_environment
      solve( Icu_memory_1( $ICU, dh_icu_priv,
                           <'cert', $Kernel, pk(x.1), kernel_sig>, n_icu.1
             ) ▶₀ #j )
        case icu_to_kernel_1_case_1
        solve( !KU( sign(~n_kernel, x) ) @ #vk.7 )
          case icu_to_kernel_1_case_1
          solve( !KU( sign(n_icu, ~icu_priv) ) @ #vk.6 )
            case icu_to_kernel_1_case_1
            solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.11 )
              case icu_to_kernel_1_case_5
              solve( !KU( sign(~n_icu, x) ) @ #vk.26 )
                case kernel_to_icu_2
                solve( !KU( sign(~n_icu, x.1) ) @ #vk.42 )
                  case icu_to_kernel_1
                  solve( !KU( sign(~n_kernel.1, ~icu_priv) ) @ #vk.45 )
                    case icu_to_kernel_1_case_1
                    solve( NextICUCounter( x ) ▶₂ #vr.3 )
                      case initialize_environment
                      solve( !KU( ~n_kernel ) @ #vk.31 )
                        case kernel_to_icu_1
                        solve( !KU( ~n_icu ) @ #vk.14 )
                          case icu_to_kernel_1
                          solve( !KU( sign(<$ICU, pk(~icu_priv)>, ~ca_priv) ) @ #vk.26 )
                            case icu_to_kernel_1_case_1
                            solve( !KU( sign('g'^~dh_kernel_priv, ~kernel_priv) ) @ #vk.30 )
                              case kernel_to_icu_2_case_2
                              solve( !KU( sign(~n_kernel, ~kernel_priv) ) @ #vk.32 )
                                case kernel_to_icu_1
                                solve( !KU( sign(<$Kernel, pk(~kernel_priv)>, ~ca_priv) ) @ #vk.37 )
                                  case kernel_to_icu_1
                                  solve( !KU( pk(~icu_priv) ) @ #vk.30 )
                                    case icu_to_kernel_1
                                    solve( !KU( pk(~kernel_priv) ) @ #vk.37 )
                                      case kernel_to_icu_1
                                      solve( !KU( 'g'^~dh_icu_priv ) @ #vk.30 )
                                        case icu_to_kernel_1
                                        solve( !KU( 'g'^~dh_kernel_priv ) @ #vk.35 )
                                          case kernel_to_icu_2
                                          SOLVED // trace found
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma trust_can_be_established:
  exists-trace
  "((∀ icu1 icu2 #i #j.
      ((RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j)) ⇒
      (icu1 = icu2)) ∧
    (¬(∃ icu x #i. ResetIcu( icu, x ) @ #i))) ∧
   (∃ kernel icu common_key #i #j.
     (KernelTrusts( kernel, icu, common_key ) @ #i) ∧
     (ICUTrusts( icu, kernel, common_key ) @ #j))"
/*
guarded formula characterizing all satisfying traces:
"(∀ icu1 icu2 #i #j.
   (RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j) ⇒ icu1 = icu2) ∧
 (∀ icu x #i. (ResetIcu( icu, x ) @ #i) ⇒ ⊥) ∧
 (∃ kernel icu common_key #i #j.
   (KernelTrusts( kernel, icu, common_key ) @ #i) ∧
   (ICUTrusts( icu, kernel, common_key ) @ #j))"
*/
simplify
solve( KernelConnection( $Kernel, $ICU, common_key ) ▶₀ #i )
  case kernel_to_icu_2
  solve( ICUConnection( $ICU, $Kernel, common_key ) ▶₀ #j )
    case icu_to_kernel_2_case_1
    solve( !KU( sign(~n_kernel, x) ) @ #vk.13 )
      case icu_to_kernel_1_case_1
      solve( !KU( sign(n_icu, ~icu_priv) ) @ #vk.12 )
        case icu_to_kernel_1_case_1
        solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.17 )
          case icu_to_kernel_1_case_5
          solve( !KU( sign(~n_icu, x) ) @ #vk.32 )
            case kernel_to_icu_2
            solve( !KU( sign(~n_icu, x.1) ) @ #vk.48 )
              case icu_to_kernel_1
              solve( !KU( sign(~n_kernel.1, ~icu_priv) ) @ #vk.51 )
                case icu_to_kernel_1_case_1
                solve( NextICUCounter( x ) ▶₂ #vr.5 )
                  case initialize_environment
                  solve( !KU( ~n_kernel ) @ #vk.37 )
                    case kernel_to_icu_1
                    solve( !KU( ~n_icu ) @ #vk.20 )
                      case icu_to_kernel_1
                      solve( !KU( sign(<$ICU, pk(~icu_priv)>, ~ca_priv) ) @ #vk.32 )
                        case icu_to_kernel_1_case_1
                        solve( !KU( sign('g'^~dh_kernel_priv, ~kernel_priv) ) @ #vk.36 )
                          case kernel_to_icu_2_case_2
                          solve( !KU( sign(~n_kernel, ~kernel_priv) ) @ #vk.38 )
                            case kernel_to_icu_1
                            solve( !KU( sign(<$Kernel, pk(~kernel_priv)>, ~ca_priv) ) @ #vk.43 )
                              case kernel_to_icu_1
                              solve( !KU( senc('ICU_Ok', 'g'^(~dh_icu_priv*~dh_kernel_priv))
                                     ) @ #vk.27 )
                                case icu_to_kernel_2_case_1
                                solve( !KU( senc('Kernel_Ok', 'g'^(~dh_icu_priv*~dh_kernel_priv))
                                       ) @ #vk.31 )
                                  case kernel_to_icu_3
                                  solve( splitEqs(7) )
                                    case split_case_1
                                    solve( !KU( pk(~icu_priv) ) @ #vk.38 )
                                      case icu_to_kernel_1
                                      solve( !KU( pk(~kernel_priv) ) @ #vk.43 )
                                        case kernel_to_icu_1
                                        solve( !KU( 'g'^~dh_icu_priv ) @ #vk.37 )
                                          case icu_to_kernel_1
                                          solve( !KU( 'g'^~dh_kernel_priv ) @ #vk.41 )
                                            case kernel_to_icu_2
                                            SOLVED // trace found
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma attacker_does_not_know_kernel_keys:
  all-traces
  "∀ kkey #i. (KernelKey( kkey ) @ #i) ⇒ (¬(∃ #j. K( kkey ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ kkey #i. (KernelKey( kkey ) @ #i) ∧ ∃ #j. (K( kkey ) @ #j)"
*/
simplify
by solve( !KU( ~kernel_priv ) @ #vk )

lemma attacker_does_not_know_icu_keys:
  all-traces "∀ ikey #i. (IcuKey( ikey ) @ #i) ⇒ (¬(∃ #j. K( ikey ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ ikey #i. (IcuKey( ikey ) @ #i) ∧ ∃ #j. (K( ikey ) @ #j)"
*/
simplify
solve( !CaPriv( ~ca_priv ) ▶₁ #i )
  case initialize_environment
  by solve( !KU( ~icu_priv ) @ #vk )
qed

lemma attacker_does_not_know_ca_keys:
  all-traces
  "∀ cakey #i. (CaKey( cakey ) @ #i) ⇒ (¬(∃ #j. K( cakey ) @ #j))"
/*
guarded formula characterizing all counter-examples:
"∃ cakey #i. (CaKey( cakey ) @ #i) ∧ ∃ #j. (K( cakey ) @ #j)"
*/
simplify
by solve( !KU( ~ca_priv ) @ #vk )

lemma attacker_does_not_know_symmetric_keys:
  all-traces
  "∀ num_icu #n.
    (RegisteredICUs( num_icu ) @ #n) ⇒
    (∀ reset_num #r.
      (TotalResets( reset_num ) @ #r) ⇒
      (∀ kernel icu common_key #i #j.
        ((KernelDone( kernel, icu, common_key ) @ #i) ∧
         (ICUDone( icu, kernel, common_key ) @ #j)) ⇒
        (¬(∃ #k. K( common_key ) @ #k))))"
/*
guarded formula characterizing all counter-examples:
"∃ num_icu #n.
  (RegisteredICUs( num_icu ) @ #n)
 ∧
  ∃ reset_num #r.
   (TotalResets( reset_num ) @ #r)
  ∧
   ∃ kernel icu common_key #i #j.
    (KernelDone( kernel, icu, common_key ) @ #i) ∧
    (ICUDone( icu, kernel, common_key ) @ #j)
   ∧
    ∃ #k. (K( common_key ) @ #k)"
*/
simplify
solve( !CaPriv( ~ca_priv ) ▶₁ #n )
  case initialize_environment
  solve( Kernel_memory_1( $Kernel, n_kernel ) ▶₀ #i )
    case kernel_to_icu_1
    solve( !KernelPrivKey( $Kernel, kernel_priv ) ▶₃ #i )
      case initialize_environment
      solve( !CaPub( pk(x.1) ) ▶₄ #i )
        case initialize_environment
        solve( Icu_memory_1( $ICU, dh_icu_priv,
                             <'cert', $Kernel, pk(x.1), kernel_sig>, n_icu.1
               ) ▶₀ #j )
          case icu_to_kernel_1_case_1
          solve( splitEqs(2) )
            case split_case_1
            solve( !KU( common_key^inv(~dh_kernel_priv) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.40 )
            qed
          next
            case split_case_2
            solve( splitEqs(3) )
              case split
              solve( !KU( dh_icu_pub^(~dh_kernel_priv*inv(~dh_icu_priv)) ) @ #vk.27 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.40 )
              next
                case kernel_to_icu_2
                by solve( !KU( ~dh_icu_priv ) @ #vk.40 )
              qed
            qed
          next
            case split_case_3
            solve( !KU( x.1^(~dh_kernel_priv*x.2) ) @ #vk.28 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.41 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.50 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.50 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.57 )
            next
              case kernel_to_icu_2_case_3
              solve( splitEqs(3) )
                case split_case_1
                by solve( !KU( ~dh_icu_priv ) @ #vk.39 )
              next
                case split_case_2
                solve( !KU( 'g'^(~dh_kernel_priv*x.1*inv(~dh_icu_priv)) ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.42 )
                next
                  case icu_to_kernel_1_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_2
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_4
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case kernel_to_icu_2_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
                next
                  case kernel_to_icu_2_case_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.42 )
                next
                  case kernel_to_icu_2_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
                qed
              next
                case split_case_3
                solve( !KU( 'g'^(~dh_kernel_priv*inv((~dh_icu_priv*x.1))) ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.44 )
                next
                  case kernel_to_icu_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.43 )
                qed
              next
                case split_case_4
                by solve( !KU( ~dh_icu_priv ) @ #vk.40 )
              next
                case split_case_5
                solve( !KU( 'g'^(~dh_kernel_priv*x.1*inv((~dh_icu_priv*x.2)))
                       ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.46 )
                next
                  case icu_to_kernel_1_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_2
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_4
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case kernel_to_icu_2_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.62 )
                next
                  case kernel_to_icu_2_case_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.46 )
                next
                  case kernel_to_icu_2_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.62 )
                qed
              qed
            qed
          next
            case split_case_4
            solve( !KU( x.1^(x.2*inv(~dh_kernel_priv)) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.43 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.53 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.53 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.57 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.59 )
            qed
          next
            case split_case_5
            solve( !KU( x.1^inv((~dh_kernel_priv*x.2)) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.42 )
            qed
          next
            case split_case_6
            solve( !KU( x.1^(x.2*inv((~dh_kernel_priv*x.3))) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.44 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.54 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.54 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.60 )
            qed
          qed
        next
          case icu_to_kernel_1_case_2
          solve( splitEqs(2) )
            case split_case_1
            solve( !KU( common_key^inv(~dh_kernel_priv) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.40 )
            qed
          next
            case split_case_2
            solve( splitEqs(3) )
              case split
              solve( !KU( dh_icu_pub^(~dh_kernel_priv*inv(~dh_icu_priv)) ) @ #vk.27 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.40 )
              next
                case kernel_to_icu_2
                by solve( !KU( ~dh_icu_priv ) @ #vk.40 )
              qed
            qed
          next
            case split_case_3
            solve( !KU( x.1^(~dh_kernel_priv*x.2) ) @ #vk.28 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.41 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.50 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.50 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.57 )
            next
              case kernel_to_icu_2_case_3
              solve( splitEqs(3) )
                case split_case_1
                by solve( !KU( ~dh_icu_priv ) @ #vk.39 )
              next
                case split_case_2
                solve( !KU( 'g'^(~dh_kernel_priv*x.1*inv(~dh_icu_priv)) ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.42 )
                next
                  case icu_to_kernel_1_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_2
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case icu_to_kernel_1_case_4
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
                next
                  case kernel_to_icu_2_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
                next
                  case kernel_to_icu_2_case_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.42 )
                next
                  case kernel_to_icu_2_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
                qed
              next
                case split_case_3
                solve( !KU( 'g'^(~dh_kernel_priv*inv((~dh_icu_priv*x.1))) ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.44 )
                next
                  case kernel_to_icu_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.43 )
                qed
              next
                case split_case_4
                by solve( !KU( ~dh_icu_priv ) @ #vk.40 )
              next
                case split_case_5
                solve( !KU( 'g'^(~dh_kernel_priv*x.1*inv((~dh_icu_priv*x.2)))
                       ) @ #vk.29 )
                  case c_exp
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.46 )
                next
                  case icu_to_kernel_1_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_2
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case icu_to_kernel_1_case_4
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.56 )
                next
                  case kernel_to_icu_2_case_1
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.62 )
                next
                  case kernel_to_icu_2_case_2
                  by solve( !KU( ~dh_icu_priv ) @ #vk.46 )
                next
                  case kernel_to_icu_2_case_3
                  by solve( !KU( ~dh_kernel_priv ) @ #vk.62 )
                qed
              qed
            qed
          next
            case split_case_4
            solve( !KU( x.1^(x.2*inv(~dh_kernel_priv)) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.43 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.53 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.51 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.53 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.57 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.59 )
            qed
          next
            case split_case_5
            solve( !KU( x.1^inv((~dh_kernel_priv*x.2)) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.42 )
            qed
          next
            case split_case_6
            solve( !KU( x.1^(x.2*inv((~dh_kernel_priv*x.3))) ) @ #vk.9 )
              case c_exp
              by solve( !KU( ~dh_kernel_priv ) @ #vk.44 )
            next
              case icu_to_kernel_1_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
            next
              case icu_to_kernel_1_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.54 )
            next
              case icu_to_kernel_1_case_3
              by solve( !KU( ~dh_kernel_priv ) @ #vk.52 )
            next
              case icu_to_kernel_1_case_4
              by solve( !KU( ~dh_kernel_priv ) @ #vk.54 )
            next
              case kernel_to_icu_2_case_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.58 )
            next
              case kernel_to_icu_2_case_2
              by solve( !KU( ~dh_kernel_priv ) @ #vk.60 )
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma kernel_trust_means_icu_done:
  all-traces
  "((∀ icu1 icu2 #i #j.
      ((RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j)) ⇒
      (icu1 = icu2)) ∧
    (¬(∃ icu x #i. ResetIcu( icu, x ) @ #i))) ⇒
   (∀ icu kernel common_key #i.
     (KernelTrusts( kernel, icu, common_key ) @ #i) ⇒
     (∃ #j. (#j < #i) ∧ (ICUDone( icu, kernel, common_key ) @ #j)))"
/*
guarded formula characterizing all counter-examples:
"(∀ icu1 icu2 #i #j.
   (RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j) ⇒ icu1 = icu2) ∧
 (∀ icu x #i. (ResetIcu( icu, x ) @ #i) ⇒ ⊥) ∧
 (∃ icu kernel common_key #i.
   (KernelTrusts( kernel, icu, common_key ) @ #i)
  ∧
   ∀ #j. (ICUDone( icu, kernel, common_key ) @ #j) ⇒ ¬(#j < #i))"
*/
simplify
solve( !KU( senc('ICU_Ok', common_key) ) @ #vk.2 )
  case c_senc
  solve( KernelConnection( $Kernel, icu, common_key ) ▶₀ #i )
    case kernel_to_icu_2
    solve( !KU( sign(<icu, pk(x)>, ~ca_priv) ) @ #vk.23 )
      case c_sign
      by solve( !KU( ~ca_priv ) @ #vk.25 )
    next
      case icu_to_kernel_1_case_1
      solve( !KU( sign(<kernel, pk(x)>, ~ca_priv) ) @ #vk.35 )
        case c_sign
        by solve( !KU( ~ca_priv ) @ #vk.37 )
      next
        case icu_to_kernel_1
        by contradiction /* cyclic */
      next
        case kernel_to_icu_1
        solve( !KU( sign(n_icu.1, ~icu_priv) ) @ #vk.14 )
          case c_sign
          by solve( !KU( ~icu_priv ) @ #vk.36 )
        next
          case icu_to_kernel_1_case_1
          solve( !KU( sign(~n_kernel.1, ~icu_priv) ) @ #vk.19 )
            case c_sign
            by solve( !KU( ~icu_priv ) @ #vk.37 )
          next
            case icu_to_kernel_1_case_1
            solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.25 )
              case c_sign
              by solve( !KU( ~icu_priv ) @ #vk.36 )
            next
              case icu_to_kernel_1_case_1
              solve( !KU( ~n_icu^~dh_kernel_priv ) @ #vk.18 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_2
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_3
              solve( !KU( ~n_kernel^~dh_kernel_priv ) @ #vk.18 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_4
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_5
              solve( !KU( 'g'^(~dh_icu_priv*~dh_kernel_priv) ) @ #vk.21 )
                case c_exp
                by solve( !KU( ~dh_icu_priv ) @ #vk.38 )
              next
                case icu_to_kernel_1
                by solve( !KU( ~dh_kernel_priv ) @ #vk.36 )
              next
                case kernel_to_icu_2
                by solve( !KU( ~dh_icu_priv ) @ #vk.36 )
              qed
            next
              case icu_to_kernel_1_case_6
              by contradiction /* from formulas */
            qed
          next
            case icu_to_kernel_1_case_2
            by contradiction /* from formulas */
          qed
        next
          case icu_to_kernel_1_case_2
          by contradiction /* from formulas */
        next
          case icu_to_kernel_1_case_3
          solve( !KU( sign(~n_kernel.1, ~icu_priv) ) @ #vk.20 )
            case c_sign
            by solve( !KU( ~icu_priv ) @ #vk.36 )
          next
            case icu_to_kernel_1_case_1
            solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.26 )
              case c_sign
              by solve( !KU( ~icu_priv ) @ #vk.34 )
            next
              case icu_to_kernel_1_case_1
              solve( !KU( ~n_icu^~dh_kernel_priv ) @ #vk.18 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_2
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_3
              solve( !KU( ~n_kernel^~dh_kernel_priv ) @ #vk.17 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.32 )
              qed
            next
              case icu_to_kernel_1_case_4
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_5
              solve( !KU( 'g'^(~dh_icu_priv*~dh_kernel_priv) ) @ #vk.19 )
                case c_exp
                by solve( !KU( ~dh_icu_priv ) @ #vk.36 )
              next
                case icu_to_kernel_1
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              next
                case kernel_to_icu_2
                by solve( !KU( ~dh_icu_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_6
              by contradiction /* from formulas */
            qed
          next
            case icu_to_kernel_1_case_2
            by contradiction /* from formulas */
          qed
        next
          case icu_to_kernel_1_case_4
          by contradiction /* from formulas */
        next
          case icu_to_kernel_1_case_5
          solve( !KU( sign(~n_kernel.1, ~icu_priv) ) @ #vk.19 )
            case c_sign
            by solve( !KU( ~icu_priv ) @ #vk.37 )
          next
            case icu_to_kernel_1_case_1
            solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.25 )
              case c_sign
              by solve( !KU( ~icu_priv ) @ #vk.36 )
            next
              case icu_to_kernel_1_case_1
              solve( !KU( ~n_icu^~dh_kernel_priv ) @ #vk.19 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.36 )
              qed
            next
              case icu_to_kernel_1_case_2
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_3
              solve( !KU( ~n_kernel^~dh_kernel_priv ) @ #vk.18 )
                case c_exp
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_4
              by contradiction /* from formulas */
            next
              case icu_to_kernel_1_case_5
              solve( !KU( 'g'^(~dh_icu_priv*~dh_kernel_priv) ) @ #vk.19 )
                case c_exp
                by solve( !KU( ~dh_icu_priv ) @ #vk.36 )
              next
                case icu_to_kernel_1
                by solve( !KU( ~dh_kernel_priv ) @ #vk.34 )
              next
                case kernel_to_icu_2
                by solve( !KU( ~dh_icu_priv ) @ #vk.34 )
              qed
            next
              case icu_to_kernel_1_case_6
              by contradiction /* from formulas */
            qed
          next
            case icu_to_kernel_1_case_2
            by contradiction /* from formulas */
          qed
        next
          case icu_to_kernel_1_case_6
          by contradiction /* from formulas */
        qed
      qed
    next
      case icu_to_kernel_1_case_2
      by contradiction /* from formulas */
    next
      case kernel_to_icu_1
      by contradiction /* from formulas */
    qed
  qed
next
  case icu_to_kernel_2_case_1
  solve( !KU( sign(<kernel, pk(x)>, ~ca_priv) ) @ #vk.22 )
    case c_sign
    solve( KernelConnection( $Kernel, icu, common_key ) ▶₀ #i )
      case kernel_to_icu_2
      solve( !KU( sign(<icu, pk(x.2)>, ~ca_priv) ) @ #vk.42 )
        case c_sign
        by solve( !KU( ~ca_priv ) @ #vk.27 )
      next
        case icu_to_kernel_1_case_1
        by solve( !KU( ~ca_priv ) @ #vk.27 )
      next
        case icu_to_kernel_1_case_2
        by contradiction /* from formulas */
      next
        case kernel_to_icu_1
        by contradiction /* from formulas */
      qed
    qed
  next
    case icu_to_kernel_1_case_1
    by contradiction /* cyclic */
  next
    case icu_to_kernel_1_case_2
    by contradiction /* from formulas */
  next
    case kernel_to_icu_1
    solve( KernelConnection( $Kernel, icu, common_key ) ▶₀ #i )
      case kernel_to_icu_2
      solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.40 )
        case c_sign
        by solve( !KU( ~ca_priv ) @ #vk.42 )
      next
        case icu_to_kernel_1_case_1
        by contradiction /* from formulas */
      next
        case icu_to_kernel_1_case_2
        by contradiction /* from formulas */
      next
        case kernel_to_icu_1
        by contradiction /* from formulas */
      qed
    qed
  qed
next
  case icu_to_kernel_2_case_2
  by contradiction /* from formulas */
qed

lemma icu_trust_means_kernel_done:
  all-traces
  "((∀ icu1 icu2 #i #j.
      ((RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j)) ⇒
      (icu1 = icu2)) ∧
    (¬(∃ icu x #i. ResetIcu( icu, x ) @ #i))) ⇒
   (∀ icu kernel common_key #i.
     (ICUTrusts( icu, kernel, common_key ) @ #i) ⇒
     (∃ #j. (#j < #i) ∧ (KernelDone( kernel, icu, common_key ) @ #j)))"
/*
guarded formula characterizing all counter-examples:
"(∀ icu1 icu2 #i #j.
   (RegisterICU( icu1 ) @ #i) ∧ (RegisterICU( icu2 ) @ #j) ⇒ icu1 = icu2) ∧
 (∀ icu x #i. (ResetIcu( icu, x ) @ #i) ⇒ ⊥) ∧
 (∃ icu kernel common_key #i.
   (ICUTrusts( icu, kernel, common_key ) @ #i)
  ∧
   ∀ #j. (KernelDone( kernel, icu, common_key ) @ #j) ⇒ ¬(#j < #i))"
*/
simplify
solve( !KU( senc('Kernel_Ok', common_key) ) @ #vk.2 )
  case c_senc
  solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
    case icu_to_kernel_2_case_1
    solve( !KU( sign(<kernel, pk(x)>, ~ca_priv) ) @ #vk.24 )
      case c_sign
      by solve( !KU( ~ca_priv ) @ #vk.26 )
    next
      case icu_to_kernel_1_case_1
      by contradiction /* cyclic */
    next
      case icu_to_kernel_1_case_2
      by contradiction /* from formulas */
    next
      case kernel_to_icu_1
      solve( !KU( sign(~n_icu, ~kernel_priv) ) @ #vk.9 )
        case c_sign
        by solve( !KU( ~kernel_priv ) @ #vk.26 )
      next
        case kernel_to_icu_2
        solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.42 )
          case c_sign
          by solve( !KU( ~ca_priv ) @ #vk.44 )
        next
          case icu_to_kernel_1_case_1
          solve( !KU( sign(dh_kernel_pub, ~kernel_priv) ) @ #vk.17 )
            case c_sign
            by solve( !KU( ~kernel_priv ) @ #vk.43 )
          next
            case kernel_to_icu_1
            solve( !KU( sign(n_kernel.2, ~kernel_priv) ) @ #vk.25 )
              case c_sign
              by solve( !KU( ~kernel_priv ) @ #vk.43 )
            next
              case kernel_to_icu_1
              solve( !KU( sign(~n_kernel.3, ~icu_priv) ) @ #vk.38 )
                case c_sign
                by solve( !KU( ~icu_priv ) @ #vk.44 )
              next
                case icu_to_kernel_1_case_1
                solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.40 )
                  case c_sign
                  by solve( !KU( ~icu_priv ) @ #vk.43 )
                next
                  case icu_to_kernel_1_case_1
                  solve( !KU( ~n_kernel^~dh_icu_priv ) @ #vk.25 )
                    case c_exp
                    by solve( !KU( ~dh_icu_priv ) @ #vk.41 )
                  qed
                next
                  case icu_to_kernel_1_case_2
                  by contradiction /* from formulas */
                next
                  case icu_to_kernel_1_case_3
                  solve( !KU( ~n_kernel^~dh_icu_priv ) @ #vk.24 )
                    case c_exp
                    by solve( !KU( ~dh_icu_priv ) @ #vk.41 )
                  qed
                next
                  case icu_to_kernel_1_case_4
                  by contradiction /* from formulas */
                next
                  case icu_to_kernel_1_case_5
                  solve( !KU( ~n_kernel^~dh_icu_priv ) @ #vk.29 )
                    case c_exp
                    by solve( !KU( ~dh_icu_priv ) @ #vk.43 )
                  qed
                next
                  case icu_to_kernel_1_case_6
                  by contradiction /* from formulas */
                qed
              next
                case icu_to_kernel_1_case_2
                by contradiction /* from formulas */
              qed
            next
              case kernel_to_icu_2_case_1
              solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.58 )
                case c_sign
                by solve( !KU( ~ca_priv ) @ #vk.60 )
              next
                case icu_to_kernel_1
                by contradiction /* cyclic */
              next
                case kernel_to_icu_1
                by contradiction /* cyclic */
              qed
            next
              case kernel_to_icu_2_case_2
              solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.59 )
                case c_sign
                by solve( !KU( ~ca_priv ) @ #vk.61 )
              next
                case icu_to_kernel_1
                by contradiction /* cyclic */
              next
                case kernel_to_icu_1
                by contradiction /* from formulas */
              qed
            qed
          next
            case kernel_to_icu_2_case_1
            solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.58 )
              case c_sign
              by solve( !KU( ~ca_priv ) @ #vk.60 )
            next
              case icu_to_kernel_1
              solve( !KU( sign(n_kernel.1, ~kernel_priv) ) @ #vk.29 )
                case c_sign
                by solve( !KU( ~kernel_priv ) @ #vk.53 )
              next
                case kernel_to_icu_1
                solve( !KU( sign(~n_kernel.2, ~icu_priv) ) @ #vk.42 )
                  case c_sign
                  by solve( !KU( ~icu_priv ) @ #vk.54 )
                next
                  case icu_to_kernel_1_case_1
                  solve( !KU( sign(dh_icu_pub, ~icu_priv) ) @ #vk.45 )
                    case c_sign
                    by solve( !KU( ~icu_priv ) @ #vk.53 )
                  next
                    case icu_to_kernel_1_case_1
                    solve( !KU( sign(dh_kernel_pub, ~icu_priv) ) @ #vk.47 )
                      case c_sign
                      by solve( !KU( ~icu_priv ) @ #vk.51 )
                    next
                      case icu_to_kernel_1_case_1
                      solve( !KU( ~n_icu^~dh_icu_priv ) @ #vk.26 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.39 )
                      qed
                    next
                      case icu_to_kernel_1_case_2
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_3
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_4
                      solve( !KU( 'g'^(~dh_icu_priv*~dh_icu_priv) ) @ #vk.31 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.53 )
                      next
                        case icu_to_kernel_1
                        by solve( !KU( ~dh_icu_priv ) @ #vk.51 )
                      qed
                    next
                      case icu_to_kernel_1_case_5
                      by contradiction /* from formulas */
                    qed
                  next
                    case icu_to_kernel_1_case_2
                    by contradiction /* from formulas */
                  next
                    case icu_to_kernel_1_case_3
                    solve( !KU( sign(dh_kernel_pub, ~icu_priv) ) @ #vk.47 )
                      case c_sign
                      by solve( !KU( ~icu_priv ) @ #vk.51 )
                    next
                      case icu_to_kernel_1_case_1
                      solve( !KU( ~n_icu^~dh_icu_priv ) @ #vk.26 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.39 )
                      qed
                    next
                      case icu_to_kernel_1_case_2
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_3
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_4
                      solve( !KU( 'g'^(~dh_icu_priv*~dh_icu_priv) ) @ #vk.30 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.53 )
                      next
                        case icu_to_kernel_1
                        by solve( !KU( ~dh_icu_priv ) @ #vk.51 )
                      qed
                    next
                      case icu_to_kernel_1_case_5
                      by contradiction /* from formulas */
                    qed
                  next
                    case icu_to_kernel_1_case_4
                    by contradiction /* from formulas */
                  next
                    case icu_to_kernel_1_case_5
                    solve( !KU( sign(dh_kernel_pub, ~icu_priv) ) @ #vk.49 )
                      case c_sign
                      by solve( !KU( ~icu_priv ) @ #vk.53 )
                    next
                      case icu_to_kernel_1_case_1
                      solve( !KU( ~n_icu^~dh_icu_priv ) @ #vk.29 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.41 )
                      qed
                    next
                      case icu_to_kernel_1_case_2
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_3
                      by contradiction /* from formulas */
                    next
                      case icu_to_kernel_1_case_4
                      solve( !KU( 'g'^(~dh_icu_priv*~dh_icu_priv) ) @ #vk.33 )
                        case c_exp
                        by solve( !KU( ~dh_icu_priv ) @ #vk.53 )
                      next
                        case icu_to_kernel_1
                        by solve( !KU( ~dh_icu_priv ) @ #vk.51 )
                      qed
                    next
                      case icu_to_kernel_1_case_5
                      by contradiction /* from formulas */
                    qed
                  next
                    case icu_to_kernel_1_case_6
                    by contradiction /* from formulas */
                  qed
                next
                  case icu_to_kernel_1_case_2
                  by contradiction /* from formulas */
                qed
              next
                case kernel_to_icu_2_case_1
                solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.68 )
                  case c_sign
                  by solve( !KU( ~ca_priv ) @ #vk.70 )
                next
                  case icu_to_kernel_1
                  by contradiction /* cyclic */
                next
                  case kernel_to_icu_1
                  by contradiction /* cyclic */
                qed
              next
                case kernel_to_icu_2_case_2
                solve( !KU( sign(<icu, pk(x.1)>, ~ca_priv) ) @ #vk.69 )
                  case c_sign
                  by solve( !KU( ~ca_priv ) @ #vk.71 )
                next
                  case icu_to_kernel_1
                  by contradiction /* cyclic */
                next
                  case kernel_to_icu_1
                  by contradiction /* from formulas */
                qed
              qed
            next
              case kernel_to_icu_1
              by contradiction /* cyclic */
            qed
          next
            case kernel_to_icu_2_case_2
            solve( !KU( 'g'^(~dh_icu_priv*~dh_kernel_priv) ) @ #vk.14 )
              case c_exp
              by solve( !KU( ~dh_icu_priv ) @ #vk.62 )
            next
              case icu_to_kernel_1
              by solve( !KU( ~dh_kernel_priv ) @ #vk.60 )
            next
              case kernel_to_icu_2
              by solve( !KU( ~dh_icu_priv ) @ #vk.60 )
            qed
          qed
        next
          case icu_to_kernel_1_case_2
          by contradiction /* from formulas */
        next
          case kernel_to_icu_1
          by contradiction /* cyclic */
        qed
      qed
    qed
  next
    case icu_to_kernel_2_case_2
    by contradiction /* from formulas */
  qed
next
  case kernel_to_icu_3
  solve( !KU( sign(<icu, pk(x)>, ~ca_priv) ) @ #vk.24 )
    case c_sign
    solve( !KU( senc('ICU_Ok', common_key) ) @ #vk.6 )
      case c_senc
      solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
        case icu_to_kernel_2_case_1
        solve( !KU( sign(<kernel, pk(x.1)>, ~ca_priv) ) @ #vk.47 )
          case c_sign
          by solve( !KU( ~ca_priv ) @ #vk.29 )
        next
          case icu_to_kernel_1_case_1
          by contradiction /* cyclic */
        next
          case icu_to_kernel_1_case_2
          by contradiction /* from formulas */
        next
          case kernel_to_icu_1
          by solve( !KU( ~ca_priv ) @ #vk.29 )
        qed
      next
        case icu_to_kernel_2_case_2
        by contradiction /* from formulas */
      qed
    next
      case icu_to_kernel_2_case_1
      solve( !KU( sign(<kernel.1, pk(x.1)>, ~ca_priv) ) @ #vk.45 )
        case c_sign
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by solve( !KU( ~ca_priv ) @ #vk.31 )
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      next
        case icu_to_kernel_1_case_1
        by contradiction /* cyclic */
      next
        case icu_to_kernel_1_case_2
        by contradiction /* from formulas */
      next
        case kernel_to_icu_1
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by solve( !KU( ~ca_priv ) @ #vk.32 )
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      qed
    next
      case icu_to_kernel_2_case_2
      by contradiction /* from formulas */
    qed
  next
    case icu_to_kernel_1_case_1
    solve( !KU( sign(<kernel.1, pk(x)>, ~ca_priv) ) @ #vk.36 )
      case c_sign
      solve( !KU( senc('ICU_Ok', common_key) ) @ #vk.8 )
        case c_senc
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by solve( !KU( ~ca_priv ) @ #vk.38 )
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      next
        case icu_to_kernel_2_case_1
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by solve( !KU( ~ca_priv ) @ #vk.38 )
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      next
        case icu_to_kernel_2_case_2
        by contradiction /* from formulas */
      qed
    next
      case icu_to_kernel_1
      by contradiction /* cyclic */
    next
      case kernel_to_icu_1
      solve( !KU( senc('ICU_Ok', common_key) ) @ #vk.8 )
        case c_senc
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by contradiction /* from formulas */
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      next
        case icu_to_kernel_2_case_1
        solve( ICUConnection( $ICU, kernel, common_key ) ▶₀ #i )
          case icu_to_kernel_2_case_1
          by contradiction /* from formulas */
        next
          case icu_to_kernel_2_case_2
          by contradiction /* from formulas */
        qed
      next
        case icu_to_kernel_2_case_2
        by contradiction /* from formulas */
      qed
    qed
  next
    case icu_to_kernel_1_case_2
    by contradiction /* from formulas */
  next
    case kernel_to_icu_1
    by contradiction /* from formulas */
  qed
qed

/* All well-formedness checks were successful. */

end